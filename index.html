<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <meta name="description" content="Senior-Easy - Aplikacja dla seniorÃ³w uÅ‚atwiajÄ…ca kontakt z rodzinÄ… i zarzÄ…dzanie lekami" />
  <meta name="theme-color" content="#3B82F6" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="Senior-Easy" />
  
  <title>Senior-Easy - Aplikacja dla SeniorÃ³w</title>
  
  <!-- UsuniÄ™to link do manifest.json ktÃ³ry powoduje 404 -->
  <!-- <link rel="manifest" href="/manifest.json" /> -->
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config = { important: true }</script>
  
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{width:100%;height:100%;overflow-x:hidden;overscroll-behavior-y:contain;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:linear-gradient(135deg,#dbeafe 0%,#e9d5ff 100%)}
    *{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}
    input,textarea,select{-webkit-user-select:text;user-select:text}
    button{cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,.1)}
    
    .emergency-button{position:fixed;bottom:100px;right:20px;width:70px;height:70px;border-radius:50%;background:linear-gradient(to bottom,#ff3333,#cc0000);box-shadow:0 4px 15px rgba(255,0,0,0.5);display:flex;align-items:center;justify-content:center;color:white;font-size:24px;font-weight:bold;z-index:100;border:3px solid white;animation:pulse 2s infinite;transition:all 0.3s ease}
    .emergency-button:active{transform:scale(0.9);box-shadow:0 2px 8px rgba(255,0,0,0.7)}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(255,0,0,0.7)}70%{box-shadow:0 0 0 15px rgba(255,0,0,0)}100%{box-shadow:0 0 0 0 rgba(255,0,0,0)}}
    
    .weekday-button{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:2px;border:2px solid #e5e5e5;background:white;font-weight:bold}
    .weekday-button.selected{background:#3B82F6;color:white;border-color:#3B82F6}
    .weekday-button:active{transform:scale(0.95)}
    
    .notification-badge{position:absolute;top:-5px;right:-5px;background:red;color:white;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:bold}
    
    .loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}
    .loading-spinner{width:50px;height:50px;border:5px solid #ffffff33;border-top:5px solid white;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px}
    @keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
    
    .weather-icon{font-size:60px;text-align:center}
    .news-item{border-bottom:2px solid #e5e5e5;padding-bottom:12px;margin-bottom:12px}
    .news-item:last-child{border-bottom:none}
    .fun-fact{background:linear-gradient(135deg,#f0f9ff 0%,#fef7ff 100%);border-left:5px solid #3B82F6}
  </style>
</head>
<body>
  <div id="root" class="p-2 sm:p-4 max-w-4xl mx-auto pb-20 min-h-screen"></div>

  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <script>
  const { useState, useEffect, useRef } = React;

  function SeniorEasyApp() {
    const [currentScreen, setCurrentScreen] = useState('home');
    const [medications, setMedications] = useState([]);
    const [familyContacts, setFamilyContacts] = useState([]);
    const [localServices, setLocalServices] = useState([]);
    const [notifications, setNotifications] = useState([]);
    const [careMode, setCareMode] = useState(true);
    const [showInstallPrompt, setShowInstallPrompt] = useState(false);
    const [deferredPrompt, setDeferredPrompt] = useState(null);
    const [showNotifyDialog, setShowNotifyDialog] = useState(false);
    const [selectedMedication, setSelectedMedication] = useState(null);
    const [showEmergencyDialog, setShowEmergencyDialog] = useState(false);
    const [showEmergencySettings, setShowEmergencySettings] = useState(false);
    const [emergencySettingsTab, setEmergencySettingsTab] = useState('appearance');
    const [isInstallable, setIsInstallable] = useState(false);
    const [isLoading, setIsLoading] = useState(true);

    const [newMedName, setNewMedName] = useState('');
    const [newMedTime, setNewMedTime] = useState('');
    const [newMedDays, setNewMedDays] = useState([]);
    const [newContactName, setNewContactName] = useState('');
    const [newContactPhone, setNewContactPhone] = useState('');
    const [newContactApp, setNewContactApp] = useState('');
    const [newServiceName, setNewServiceName] = useState('');
    const [newServicePhone, setNewServicePhone] = useState('');
    const [newServiceIcon, setNewServiceIcon] = useState('');
    const [editingContact, setEditingContact] = useState(null);
    const [editingService, setEditingService] = useState(null);
    const [editingMedication, setEditingMedication] = useState(null);

    const [emergencySettings, setEmergencySettings] = useState({
      enabled: true,
      position: 'bottom-right',
      size: 70,
      color: 'red',
      pulse: true,
      familyMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy! ProszÄ™ o kontakt.',
      medicalMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy medycznej! ProszÄ™ o natychmiastowy kontakt.',
      servicesMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy! ProszÄ™ o kontakt.',
      familyPhones: [],
      medicalPhones: ['112', '999'],
      servicesPhones: ['997', '998']
    });

    const [newPhoneNumber, setNewPhoneNumber] = useState('');
    const [editingPhoneType, setEditingPhoneType] = useState('family');
    const weekdays = ['Pon', 'Wt', 'Åšr', 'Czw', 'Pt', 'Sb', 'Nd'];
    const fileInputRef = useRef(null);

    // DODANE NOWE STANY
    const [weather, setWeather] = useState(null);
    const [news, setNews] = useState([]);
    const [funFacts, setFunFacts] = useState([]);
    const [currentFunFact, setCurrentFunFact] = useState('');
    const [weatherLoading, setWeatherLoading] = useState(false);
    const [newsLoading, setNewsLoading] = useState(false);
    const [userLocation, setUserLocation] = useState(null);
    const [showLocationPrompt, setShowLocationPrompt] = useState(false);
    const [locationPermission, setLocationPermission] = useState(null);
    const [hasAskedForLocation, setHasAskedForLocation] = useState(false);

    // ========== FUNKCJE INSTALACJI PWA ==========
    const handleInstallClick = async () => {
      if (!deferredPrompt) {
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
          addNotification('Aby zainstalowaÄ‡ aplikacjÄ™, uÅ¼yj opcji "Dodaj do ekranu gÅ‚Ã³wnego" w Safari');
          return;
        }
        addNotification('UÅ¼yj opcji "Zainstaluj aplikacjÄ™" w menu przeglÄ…darki');
        return;
      }
      
      try {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        
        if (outcome === 'accepted') {
          addNotification('Aplikacja zostaÅ‚a zainstalowana pomyÅ›lnie!');
        } else {
          addNotification('Instalacja zostaÅ‚a anulowana.');
        }
      } catch (error) {
        addNotification('BÅ‚Ä…d podczas instalacji. SprÃ³buj ponownie.');
      }
      
      setDeferredPrompt(null); 
      setIsInstallable(false);
      setShowInstallPrompt(false);
    };

    // ========== FUNKCJE DODAWANIA POWIADOMIEÅƒ ==========
    const addNotification = text => {
      // Filtrujemy powiadomienia zwiÄ…zane z pogodÄ…
      const weatherKeywords = ['pogod', 'pobrano pogod', 'lokalizacj', 'odÅ›wieÅ¼am pogod'];
      const isWeatherNotification = weatherKeywords.some(keyword => 
        text.toLowerCase().includes(keyword.toLowerCase())
      );
      
      // JeÅ›li to powiadomienie o pogodzie, NIE dodajemy go do listy
      if (isWeatherNotification) {
        console.log('Powiadomienie o pogodzie pominiÄ™te:', text);
        return;
      }
      
      const newNotif = { 
        id: Date.now(), 
        text, 
        time: new Date().toLocaleTimeString('pl-PL', {hour:'2-digit',minute:'2-digit'}), 
        read: false 
      };
      setNotifications(prev => [newNotif, ...prev]);
    };

    // ========== FUNKCJE POGODY ==========
    const fetchWeather = async (lat, lon) => {
      setWeatherLoading(true);
      try {
        const lastWeatherFetch = localStorage.getItem('seniorEasy_lastWeatherFetch');
        const now = Date.now();
        const savedWeather = localStorage.getItem('seniorEasy_weather');
        
        if (lastWeatherFetch && savedWeather && (now - parseInt(lastWeatherFetch)) < 60 * 60 * 1000) {
          setWeather(JSON.parse(savedWeather));
          setWeatherLoading(false);
          return;
        }

        const response = await fetch('https://danepubliczne.imgw.pl/api/data/synop');
        const allStations = await response.json();
        
        let closestStation = null;
        let minDistance = Infinity;
        
        if (lat && lon) {
          allStations.forEach(station => {
            if (station.latitude && station.longitude) {
              const stationLat = parseFloat(station.latitude.replace(',', '.'));
              const stationLon = parseFloat(station.longitude.replace(',', '.'));
              
              const distance = Math.sqrt(
                Math.pow(stationLat - lat, 2) + Math.pow(stationLon - lon, 2)
              );
              
              if (distance < minDistance) {
                minDistance = distance;
                closestStation = station;
              }
            }
          });
        }
        
        const station = closestStation || allStations.find(s => s.stacja === 'Warszawa') || allStations[0];
        
        const weatherData = {
          temperature: station.temperatura ? parseFloat(station.temperatura) : Math.round(Math.random() * 15 + 5),
          feels_like: station.temperatura ? parseFloat(station.temperatura) - 2 : Math.round(Math.random() * 15 + 3),
          humidity: station.wilgotnosc_wzgledna ? parseFloat(station.wilgotnosc_wzgledna) : Math.round(Math.random() * 30 + 50),
          pressure: station.cisnienie ? parseFloat(station.cisnienie) : 1013,
          wind_speed: station.predkosc_wiatru ? parseFloat(station.predkosc_wiatru) : 0,
          description: getWeatherDescription(station),
          icon: getWeatherIcon(station),
          city: station.stacja || 'Nieznana stacja',
          station_id: station.id_stacji,
          date: station.data_pomiaru,
          time: station.godzina_pomiaru,
          forecast: generateForecast(station)
        };
        
        localStorage.setItem('seniorEasy_weather', JSON.stringify(weatherData));
        localStorage.setItem('seniorEasy_lastWeatherFetch', now.toString());
        
        setWeather(weatherData);
        setWeatherLoading(false);
        
      } catch (error) {
        console.error('BÅ‚Ä…d pobierania pogody z IMGW:', error);
        
        const mockWeather = {
          temperature: Math.round(Math.random() * 15 + 5),
          feels_like: Math.round(Math.random() * 15 + 3),
          humidity: Math.round(Math.random() * 30 + 50),
          description: ['SÅ‚onecznie', 'CzÄ™Å›ciowo pochmurnie', 'Deszczowo', 'MgÅ‚a'][Math.floor(Math.random() * 4)],
          icon: ['â˜€ï¸', 'â›…', 'ðŸŒ§ï¸', 'ðŸŒ«ï¸'][Math.floor(Math.random() * 4)],
          city: lat && lon ? `Twoja okolica` : 'Warszawa',
          forecast: [
            { day: 'Jutro', temp: Math.round(Math.random() * 15 + 5), icon: 'â›…' },
            { day: 'Pojutrze', temp: Math.round(Math.random() * 15 + 5), icon: 'ðŸŒ§ï¸' },
            { day: 'Za 3 dni', temp: Math.round(Math.random() * 15 + 5), icon: 'â˜€ï¸' }
          ]
        };
        
        setWeather(mockWeather);
        setWeatherLoading(false);
      }
    };

    const getWeatherDescription = (station) => {
      if (!station) return 'Brak danych';
      
      const temp = station.temperatura ? parseFloat(station.temperatura) : 15;
      const clouds = station.zachmurzenie ? parseFloat(station.zachmurzenie) : 0;
      const rain = station.suma_opadu ? parseFloat(station.suma_opadu) : 0;
      
      if (rain > 5) return 'Deszczowo';
      if (rain > 0.5) return 'Przelotne opady';
      if (clouds > 80) return 'Pochmurnie';
      if (clouds > 30) return 'CzÄ™Å›ciowo pochmurnie';
      if (temp > 25) return 'SÅ‚onecznie i gorÄ…co';
      if (temp > 15) return 'SÅ‚onecznie';
      if (temp > 5) return 'ChÅ‚odno';
      return 'Zimno';
    };

    const getWeatherIcon = (station) => {
      if (!station) return 'â˜€ï¸';
      
      const temp = station.temperatura ? parseFloat(station.temperatura) : 15;
      const clouds = station.zachmurzenie ? parseFloat(station.zachmurzenie) : 0;
      const rain = station.suma_opadu ? parseFloat(station.suma_opadu) : 0;
      
      if (rain > 5) return 'ðŸŒ§ï¸';
      if (rain > 0.5) return 'ðŸŒ¦ï¸';
      if (clouds > 80) return 'â˜ï¸';
      if (clouds > 30) return 'â›…';
      if (temp < 0) return 'â„ï¸';
      if (temp > 25) return 'ðŸ”¥';
      return 'â˜€ï¸';
    };

    const generateForecast = (station) => {
      const baseTemp = station.temperatura ? parseFloat(station.temperatura) : 15;
      
      return [
        { 
          day: 'Jutro', 
          temp: Math.round(baseTemp + (Math.random() * 4 - 2)),
          icon: getForecastIcon(station, 1)
        },
        { 
          day: 'Pojutrze', 
          temp: Math.round(baseTemp + (Math.random() * 6 - 3)),
          icon: getForecastIcon(station, 2)
        },
        { 
          day: 'Za 3 dni', 
          temp: Math.round(baseTemp + (Math.random() * 8 - 4)),
          icon: getForecastIcon(station, 3)
        }
      ];
    };

    const getForecastIcon = (station, daysAhead) => {
      const icons = ['â˜€ï¸', 'â›…', 'â˜ï¸', 'ðŸŒ¦ï¸', 'ðŸŒ§ï¸', 'â›ˆï¸'];
      const randomIndex = Math.floor(Math.random() * icons.length);
      return icons[randomIndex];
    };

    const refreshWeatherManually = async () => {
      try {
        if (userLocation) {
          await fetchWeather(userLocation.latitude, userLocation.longitude);
        } else {
          await fetchWeather(52.2297, 21.0122);
        }
      } catch (error) {
        console.error('BÅ‚Ä…d odÅ›wieÅ¼ania pogody:', error);
      }
    };

    // ========== FUNKCJE WIADOMOÅšCI ==========
    const fetchNews = async () => {
      setNewsLoading(true);
      
      try {
        const lastFetchTime = localStorage.getItem('seniorEasy_lastNewsFetch');
        const now = Date.now();
        
        if (lastFetchTime && (now - parseInt(lastFetchTime)) < 30 * 60 * 1000) {
          const savedNews = localStorage.getItem('seniorEasy_news');
          if (savedNews) {
            setNews(JSON.parse(savedNews));
            setNewsLoading(false);
            return;
          }
        }
        
        // Pobierz wiadomoÅ›ci z Onet.pl przez CORS proxy
        const proxyUrl = 'https://api.allorigins.win/raw?url=';
        const onetUrl = 'https://www.onet.pl/';
        
        try {
          const response = await fetch(`${proxyUrl}${encodeURIComponent(onetUrl)}`);
          
          if (!response.ok) {
            throw new Error('BÅ‚Ä…d pobierania wiadomoÅ›ci');
          }
          
          const htmlText = await response.text();
          const parser = new DOMParser();
          const doc = parser.parseFromString(htmlText, 'text/html');
          
          const articles = [];
          const selectors = [
            'article a',
            '.latestNews a',
            '.news a',
            '.item a',
            '[data-role="news-item"] a',
            '.title a'
          ];
          
          for (const selector of selectors) {
            const links = doc.querySelectorAll(selector);
            
            for (const link of links) {
              const href = link.getAttribute('href');
              const title = link.textContent.trim();
              
              if (href && title && href.includes('//') && 
                  !href.includes('#') && 
                  title.length > 20 && 
                  !articles.find(a => a.title === title)) {
                
                const isOnetLink = href.includes('onet.pl') || href.startsWith('/');
                const fullUrl = isOnetLink && href.startsWith('/') ? `https://www.onet.pl${href}` : href;
                
                articles.push({
                  title: title.length > 100 ? title.substring(0, 100) + '...' : title,
                  description: title.length > 60 ? title.substring(0, 60) + '...' : title,
                  source: 'Onet.pl',
                  category: getCategoryFromUrl(href),
                  url: fullUrl,
                  time: getRandomTime()
                });
                
                if (articles.length >= 15) break;
              }
            }
            
            if (articles.length >= 15) break;
          }
          
          if (articles.length > 0) {
            if (articles.length < 5) {
              const sampleNews = generateSampleNews();
              articles.push(...sampleNews);
            }
            
            const limitedArticles = articles.slice(0, 10);
            localStorage.setItem('seniorEasy_news', JSON.stringify(limitedArticles));
            localStorage.setItem('seniorEasy_lastNewsFetch', now.toString());
            
            setNews(limitedArticles);
            setNewsLoading(false);
            return;
          }
          
          throw new Error('Nie znaleziono artykuÅ‚Ã³w');
          
        } catch (proxyError) {
          console.error('BÅ‚Ä…d proxy:', proxyError);
          throw proxyError;
        }
        
      } catch (error) {
        console.error('BÅ‚Ä…d pobierania wiadomoÅ›ci:', error);
        const sampleNews = generateSampleNews();
        
        localStorage.setItem('seniorEasy_news', JSON.stringify(sampleNews));
        localStorage.setItem('seniorEasy_lastNewsFetch', Date.now().toString());
        
        setNews(sampleNews);
        setNewsLoading(false);
      }
    };

    const getCategoryFromUrl = (url) => {
      if (url.includes('wiadomosci')) return 'WiadomoÅ›ci';
      if (url.includes('sport')) return 'Sport';
      if (url.includes('kultura')) return 'Kultura';
      if (url.includes('rozrywka')) return 'Rozrywka';
      if (url.includes('styl-zycia')) return 'Styl Å¼ycia';
      if (url.includes('technologie')) return 'Technologie';
      if (url.includes('zdrowie')) return 'Zdrowie';
      if (url.includes('finanse')) return 'Finanse';
      return 'AktualnoÅ›ci';
    };

    const getRandomTime = () => {
      const now = new Date();
      const hoursAgo = Math.floor(Math.random() * 24);
      const time = new Date(now.getTime() - hoursAgo * 60 * 60 * 1000);
      return time.toLocaleTimeString('pl-PL', { hour: '2-digit', minute: '2-digit' });
    };

    const generateSampleNews = () => {
      const currentDate = new Date();
      const categories = ['WiadomoÅ›ci', 'Sport', 'Zdrowie', 'Finanse', 'Technologie', 'Kultura'];
      const sources = ['Onet.pl', 'WP.pl', 'TVN24', 'Polsat News'];
      
      const newsTemplates = [
        {
          title: 'Nowe Å›wiadczenia dla seniorÃ³w od 2025 roku',
          description: 'RzÄ…d zapowiada dodatkowe wsparcie finansowe dla osÃ³b powyÅ¼ej 70. roku Å¼ycia. Program obejmie Å›wiadczenia w wysokoÅ›ci 500 zÅ‚ miesiÄ™cznie.',
          category: 'WiadomoÅ›ci'
        },
        {
          title: 'BezpÅ‚atne badania przesiewowe w caÅ‚ej Polsce',
          description: 'Ministerstwo Zdrowia organizuje akcjÄ™ badaÅ„ profilaktycznych dla seniorÃ³w. Badania bÄ™dÄ… dostÄ™pne w przychodniach na terenie caÅ‚ego kraju.',
          category: 'Zdrowie'
        },
        {
          title: 'Polscy siatkarze awansowali do finaÅ‚u mistrzostw Europy',
          description: 'Reprezentacja Polski w siatkÃ³wce pokonaÅ‚a w pÃ³Å‚finale druÅ¼ynÄ™ WÅ‚och. FinaÅ‚ odbÄ™dzie siÄ™ w niedzielÄ™.',
          category: 'Sport'
        },
        {
          title: 'Wzrost emerytur od marca potwierdzony',
          description: 'ZUS ogÅ‚osiÅ‚ nowe wysokoÅ›ci waloryzacji Å›wiadczeÅ„ emerytalnych. Åšredni wzrost wyniesie 7,5% dla wszystkich emerytÃ³w.',
          category: 'Finanse'
        },
        {
          title: 'Nowe technologie dla osÃ³b starszych',
          description: 'Firmy technologiczne przygotowujÄ… specjalne aplikacje uÅ‚atwiajÄ…ce seniorom Å¼ycie codzienne. Kursy obsÅ‚ugi smartfonÃ³w w domach kultury.',
          category: 'Technologie'
        },
        {
          title: 'Kulturalne wydarzenia weekendowe dla seniorÃ³w',
          description: 'Teatry i muzea przygotowaÅ‚y specjalne programy dla starszych osÃ³b. WstÄ™p wolny dla seniorÃ³w 65+ w wybrane weekendy.',
          category: 'Kultura'
        }
      ];
      
      return newsTemplates.map((template, index) => {
        const timeOffset = index * 3600000;
        const newsDate = new Date(currentDate.getTime() - timeOffset);
        
        return {
          id: index + 1,
          title: template.title,
          description: template.description,
          time: newsDate.toLocaleTimeString('pl-PL', { hour: '2-digit', minute: '2-digit' }),
          date: newsDate.toLocaleDateString('pl-PL'),
          category: template.category,
          source: sources[Math.floor(Math.random() * sources.length)],
          url: 'https://www.onet.pl/',
          isExternal: true
        };
      });
    };

    const refreshNewsManually = async () => {
      await fetchNews();
    };

    const openFullNews = (newsItem) => {
      if (newsItem.url && newsItem.isExternal) {
        window.open(newsItem.url, '_blank');
      } else {
        console.log(`WiadomoÅ›Ä‡: ${newsItem.title}`);
      }
    };

    // ========== FUNKCJE LOKALIZACJI ==========
    const getUserLocation = () => {
      return new Promise((resolve, reject) => {
        const alreadyAsked = localStorage.getItem('seniorEasy_locationAsked');
        if (alreadyAsked === 'true' && !userLocation) {
          fetchWeather(52.2297, 21.0122);
          reject(new Error('JuÅ¼ pytano o lokalizacjÄ™'));
          return;
        }
        
        if (!navigator.geolocation) {
          localStorage.setItem('seniorEasy_locationAsked', 'true');
          fetchWeather(52.2297, 21.0122);
          reject(new Error('Twoja przeglÄ…darka nie wspiera geolokalizacji'));
          return;
        }
        
        setShowLocationPrompt(true);
        setHasAskedForLocation(true);
        
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const { latitude, longitude } = position.coords;
            setUserLocation({ latitude, longitude });
            
            localStorage.setItem('seniorEasy_userLocation', JSON.stringify({ latitude, longitude }));
            localStorage.setItem('seniorEasy_locationAsked', 'true');
            
            await fetchWeather(latitude, longitude);
            
            setShowLocationPrompt(false);
            setLocationPermission('granted');
            resolve({ latitude, longitude });
          },
          (error) => {
            console.error('BÅ‚Ä…d geolokalizacji:', error);
            
            localStorage.setItem('seniorEasy_locationAsked', 'true');
            
            const savedLocation = localStorage.getItem('seniorEasy_userLocation');
            if (savedLocation) {
              const { latitude, longitude } = JSON.parse(savedLocation);
              setUserLocation({ latitude, longitude });
              fetchWeather(latitude, longitude);
            } else {
              fetchWeather(52.2297, 21.0122);
            }
            
            setShowLocationPrompt(false);
            setLocationPermission('denied');
            reject(error);
          },
          { 
            enableHighAccuracy: true, 
            timeout: 10000, 
            maximumAge: 300000
          }
        );
      });
    };

    const checkLocationPermission = async () => {
      const alreadyAsked = localStorage.getItem('seniorEasy_locationAsked');
      
      if (alreadyAsked === 'true') {
        setHasAskedForLocation(true);
        
        const savedLocation = localStorage.getItem('seniorEasy_userLocation');
        if (savedLocation) {
          const { latitude, longitude } = JSON.parse(savedLocation);
          setUserLocation({ latitude, longitude });
          
          if (navigator.permissions && navigator.permissions.query) {
            try {
              const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });
              setLocationPermission(permissionStatus.state);
            } catch (error) {
              console.error('BÅ‚Ä…d sprawdzania pozwolenia:', error);
            }
          }
          
          fetchWeather(latitude, longitude);
          return;
        } else {
          fetchWeather(52.2297, 21.0122);
        }
        return;
      }
      
      if (navigator.permissions && navigator.permissions.query) {
        try {
          const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });
          setLocationPermission(permissionStatus.state);
          
          if (permissionStatus.state === 'granted') {
            getUserLocation();
          }
        } catch (error) {
          console.error('BÅ‚Ä…d sprawdzania pozwolenia:', error);
        }
      }
    };

    // ========== FUNKCJE LEKÃ“W ==========
    const checkMedicationReminders = () => {
      const now = new Date();
      const currentDay = (now.getDay() + 6) % 7;
      const currentTime = now.toTimeString().slice(0, 5);
      
      medications.forEach(med => {
        if (!med.days.includes(currentDay)) return;
        
        const today = now.toDateString();
        if (med.lastTaken === today) return;
        
        const [medHour, medMin] = med.time.split(':').map(Number);
        const medTime = new Date();
        medTime.setHours(medHour, medMin, 0);
        
        const reminderTime = new Date(medTime.getTime() - 15 * 60000);
        const reminderTimeStr = reminderTime.toTimeString().slice(0, 5);
        
        if (currentTime === reminderTimeStr) {
          addNotification(`â° Przypomnienie: Za 15 minut przyjmij lek "${med.name}" o ${med.time}`);
        }
        
        if (currentTime === med.time) {
          addNotification(`ðŸ’Š Czas na lek! Przyjmij "${med.name}"`);
        }
      });
    };

    const markMedicationTaken = id => {
      const medication = medications.find(med => med.id === id);
      if (!medication) return;
      
      const today = (new Date().getDay() + 6) % 7;
      const updatedDays = medication.days.filter(day => day !== today);
      const newDays = updatedDays.length === 0 ? [0, 1, 2, 3, 4, 5, 6] : updatedDays;
      const lastTaken = new Date().toDateString();
      
      setMedications(prev => prev.map(med => 
        med.id === id ? { ...med, days: newDays, lastTaken } : med
      ));
      
      if (careMode) {
        setSelectedMedication(medication);
        setShowNotifyDialog(true);
      } else {
        addNotification(`Lek "${medication.name}" zostaÅ‚ przyjÄ™ty`);
      }
    };

    const sendNotification = (contactId) => {
      if (!selectedMedication) return;
      
      const contact = familyContacts.find(c => c.id === contactId);
      if (!contact) return;
      
      const message = encodeURIComponent(`âœ… Lek "${selectedMedication.name}" zostaÅ‚ przyjÄ™ty o godzinie ${new Date().toLocaleTimeString('pl-PL', {hour:'2-digit', minute:'2-digit'})}`);
      const phone = contact.phone.replace(/[^\d+]/g, '');
      
      if (contact.app === 'whatsapp') {
        window.open(`https://api.whatsapp.com/send?phone=${phone}&text=${message}`, '_blank');
      } else if (contact.app === 'viber') {
        window.open(`viber://forward?text=${message}`, '_blank');
      } else {
        window.location.href = `sms:${phone}?body=${message}`;
      }
      
      addNotification(`WysÅ‚ano powiadomienie do ${contact.name}`);
      setShowNotifyDialog(false);
      setSelectedMedication(null);
    };

    const sendToAll = () => {
      if (!selectedMedication) return;
      
      const familyWithApps = familyContacts.filter(c => c.app === 'whatsapp' || c.app === 'viber');
      const message = encodeURIComponent(`âœ… Lek "${selectedMedication.name}" zostaÅ‚ przyjÄ™ty o godzinie ${new Date().toLocaleTimeString('pl-PL', {hour:'2-digit', minute:'2-digit'})}`);
      
      familyWithApps.forEach(contact => {
        const phone = contact.phone.replace(/[^\d+]/g, '');
        if (contact.app === 'whatsapp') {
          window.open(`https://api.whatsapp.com/send?phone=${phone}&text=${message}`, '_blank');
        } else if (contact.app === 'viber') {
          window.open(`viber://forward?text=${message}`, '_blank');
        }
      });
      
      addNotification(`WysÅ‚ano powiadomienie do ${familyWithApps.length} osÃ³b`);
      setShowNotifyDialog(false);
      setSelectedMedication(null);
    };

    // ========== FUNKCJE AWARYJNE ==========
    const sendEmergencyMessage = (type) => {
      let message = '';
      let phonesToCall = [];
      
      if (type === 'family') {
        message = encodeURIComponent(emergencySettings.familyMessage);
        phonesToCall = emergencySettings.familyPhones;
      } else if (type === 'medical') {
        message = encodeURIComponent(emergencySettings.medicalMessage);
        phonesToCall = emergencySettings.medicalPhones;
      } else if (type === 'services') {
        message = encodeURIComponent(emergencySettings.servicesMessage);
        phonesToCall = emergencySettings.servicesPhones;
      }
      
      if (type === 'family' || type === 'medical') {
        const familyWithApps = familyContacts.filter(c => c.app === 'whatsapp' || c.app === 'viber');
        
        familyWithApps.forEach(contact => {
          const phone = contact.phone.replace(/[^\d+]/g, '');
          if (contact.app === 'whatsapp') {
            window.open(`https://api.whatsapp.com/send?phone=${phone}&text=${message}`, '_blank');
          } else if (contact.app === 'viber') {
            window.open(`viber://forward?text=${message}`, '_blank');
          }
        });
        
        addNotification(`WysÅ‚ano wiadomoÅ›Ä‡ awaryjnÄ… do ${familyWithApps.length} osÃ³b`);
      }
      
      if (phonesToCall.length > 0) {
        const phoneToCall = phonesToCall[0];
        window.location.href = `tel:${phoneToCall}`;
        addNotification(`DzwoniÄ™ pod numer: ${phoneToCall}`);
      } else {
        window.location.href = 'tel:112';
        addNotification(`DzwoniÄ™ na numer alarmowy 112`);
      }
      
      setShowEmergencyDialog(false);
    };

    const updateEmergencySettings = (key, value) => {
      setEmergencySettings(prev => ({...prev, [key]: value}));
    };

    const addPhoneNumber = () => {
      if (!newPhoneNumber.trim()) return;
      const phoneKey = `${editingPhoneType}Phones`;
      const updatedPhones = [...emergencySettings[phoneKey], newPhoneNumber.trim()];
      updateEmergencySettings(phoneKey, updatedPhones);
      setNewPhoneNumber('');
    };

    const removePhoneNumber = (index, type) => {
      const phoneKey = `${type}Phones`;
      const updatedPhones = [...emergencySettings[phoneKey]];
      updatedPhones.splice(index, 1);
      updateEmergencySettings(phoneKey, updatedPhones);
    };

    const getEmergencyButtonStyle = () => {
      if (!emergencySettings.enabled) return { display: 'none' };
      
      const baseStyle = {
        width: `${emergencySettings.size}px`,
        height: `${emergencySettings.size}px`,
        fontSize: `${emergencySettings.size * 0.35}px`
      };
      
      if (emergencySettings.position === 'bottom-right') {
        baseStyle.bottom = '100px'; baseStyle.right = '20px';
      } else if (emergencySettings.position === 'bottom-left') {
        baseStyle.bottom = '100px'; baseStyle.left = '20px';
      } else if (emergencySettings.position === 'top-right') {
        baseStyle.top = '100px'; baseStyle.right = '20px';
      } else if (emergencySettings.position === 'top-left') {
        baseStyle.top = '100px'; baseStyle.left = '20px';
      }
      
      if (emergencySettings.color === 'red') {
        baseStyle.background = 'linear-gradient(to bottom, #ff3333, #cc0000)';
      } else if (emergencySettings.color === 'blue') {
        baseStyle.background = 'linear-gradient(to bottom, #3366ff, #0033cc)';
      } else if (emergencySettings.color === 'orange') {
        baseStyle.background = 'linear-gradient(to bottom, #ff9933, #cc6600)';
      }
      
      if (emergencySettings.pulse) {
        baseStyle.animation = 'pulse 2s infinite';
      } else {
        baseStyle.animation = 'none';
      }
      
      return baseStyle;
    };

    // ========== FUNKCJE DODAWANIA/MODYFIKACJI LEKÃ“W ==========
    const toggleDay = (dayIndex) => {
      if (newMedDays.includes(dayIndex)) {
        setNewMedDays(newMedDays.filter(d => d !== dayIndex));
      } else {
        setNewMedDays([...newMedDays, dayIndex]);
      }
    };

    const selectAllDays = () => setNewMedDays([0, 1, 2, 3, 4, 5, 6]);
    const clearDays = () => setNewMedDays([]);

    const addMedication = () => { 
      if (newMedName && newMedTime && newMedDays.length > 0) { 
        const newMed = { 
          id: Date.now(), 
          name: newMedName, 
          time: newMedTime, 
          days: [...newMedDays],
          lastTaken: null
        };
        setMedications(prev => [...prev, newMed]); 
        setNewMedName(''); 
        setNewMedTime(''); 
        setNewMedDays([]);
        addNotification(`Dodano nowy lek: ${newMedName}`);
      } 
    };

    const deleteMedication = id => {
      const medication = medications.find(med => med.id === id);
      if (medication && confirm(`Czy na pewno chcesz usunÄ…Ä‡ lek "${medication.name}"?`)) {
        setMedications(prev => prev.filter(med => med.id !== id));
        addNotification(`UsuniÄ™to lek: ${medication.name}`);
      }
    };
    
    const startEditMedication = (medication) => {
      setEditingMedication(medication.id);
      setNewMedName(medication.name);
      setNewMedTime(medication.time);
      setNewMedDays([...medication.days]);
    };

    const saveEditMedication = (id) => {
      setMedications(prev => prev.map(med => 
        med.id === id ? { 
          ...med, 
          name: newMedName, 
          time: newMedTime,
          days: [...newMedDays],
          lastTaken: med.lastTaken || null
        } : med
      ));
      setEditingMedication(null);
      setNewMedName('');
      setNewMedTime('');
      setNewMedDays([]);
      addNotification(`Zaktualizowano lek: ${newMedName}`);
    };

    const cancelEditMedication = () => {
      setEditingMedication(null);
      setNewMedName('');
      setNewMedTime('');
      setNewMedDays([]);
    };

    // ========== FUNKCJE KONTAKTÃ“W ==========
    const makeCall = contact => { 
      if (contact.phone) window.location.href = `tel:${contact.phone}`; 
      if (careMode) addNotification(`PoÅ‚Ä…czenie z ${contact.name}`); 
    };

    const startVideoCall = (contact) => {
      if(!contact) return;
      const phone = contact.phone.replace(/[^\d+]/g,'');
      
      if(contact.app==='whatsapp') {
        window.open(`https://api.whatsapp.com/send?phone=${phone}&text=ðŸ“¹`, '_blank');
      } else if(contact.app==='viber') {
        window.open(`viber://forward?text=ðŸ“¹`, '_blank');
      } else {
        window.location.href = `tel:${phone}`;
      }
      
      if(careMode) addNotification(`Rozmowa wideo z ${contact.name}`);
    };

    const addContact = () => { 
      if (newContactName && newContactPhone) { 
        const newContact = { 
          id: Date.now(), 
          name: newContactName, 
          phone: newContactPhone, 
          avatar: 'ðŸ‘¤', 
          app: newContactApp 
        };
        setFamilyContacts(prev => [...prev, newContact]); 
        setNewContactName(''); 
        setNewContactPhone(''); 
        setNewContactApp(''); 
        addNotification(`Dodano nowy kontakt: ${newContactName}`);
      } 
    };
    
    const deleteContact = id => {
      const contact = familyContacts.find(c => c.id === id);
      if (contact && confirm(`Czy na pewno chcesz usunÄ…Ä‡ kontakt "${contact.name}"?`)) {
        setFamilyContacts(prev => prev.filter(c => c.id !== id));
        addNotification(`UsuniÄ™to kontakt: ${contact.name}`);
      }
    };
    
    const startEditContact = contact => { 
      setEditingContact(contact.id); 
      setNewContactName(contact.name); 
      setNewContactPhone(contact.phone); 
      setNewContactApp(contact.app); 
    };
    
    const saveEditContact = id => { 
      setFamilyContacts(prev => prev.map(c => 
        c.id === id ? { ...c, name: newContactName, phone: newContactPhone, app: newContactApp } : c
      )); 
      setEditingContact(null); 
      setNewContactName(''); 
      setNewContactPhone(''); 
      setNewContactApp(''); 
      addNotification(`Zaktualizowano kontakt: ${newContactName}`);
    };
    
    const cancelEditContact = () => { 
      setEditingContact(null); 
      setNewContactName(''); 
      setNewContactPhone(''); 
      setNewContactApp(''); 
    };

    // ========== FUNKCJE USÅUG ==========
    const addService = () => { 
      if (newServiceName && newServicePhone) { 
        const newService = { 
          id: Date.now(), 
          name: newServiceName, 
          phone: newServicePhone, 
          icon: newServiceIcon || 'ðŸ¢' 
        };
        setLocalServices(prev => [...prev, newService]); 
        setNewServiceName(''); 
        setNewServicePhone(''); 
        setNewServiceIcon(''); 
        addNotification(`Dodano nowÄ… usÅ‚ugÄ™: ${newServiceName}`);
      } 
    };
    
    const deleteService = id => {
      const service = localServices.find(s => s.id === id);
      if (service && confirm(`Czy na pewno chcesz usunÄ…Ä‡ usÅ‚ugÄ™ "${service.name}"?`)) {
        setLocalServices(prev => prev.filter(s => s.id !== id));
        addNotification(`UsuniÄ™to usÅ‚ugÄ™: ${service.name}`);
      }
    };
    
    const startEditService = service => { 
      setEditingService(service.id); 
      setNewServiceName(service.name); 
      setNewServicePhone(service.phone); 
      setNewServiceIcon(service.icon); 
    };
    
    const saveEditService = id => { 
      setLocalServices(prev => prev.map(s => 
        s.id === id ? { ...s, name: newServiceName, phone: newServicePhone, icon: newServiceIcon || 'ðŸ¢' } : s
      )); 
      setEditingService(null); 
      setNewServiceName(''); 
      setNewServicePhone(''); 
      setNewServiceIcon(''); 
      addNotification(`Zaktualizowano usÅ‚ugÄ™: ${newServiceName}`);
    };
    
    const cancelEditService = () => { 
      setEditingService(null); 
      setNewServiceName(''); 
      setNewServicePhone(''); 
      setNewServiceIcon(''); 
    };

    // ========== FUNKCJE ZARZÄ„DZANIA DANYMI ==========
    const clearData = () => { 
      if (confirm('Czy na pewno chcesz wyczyÅ›ciÄ‡ wszystkie zapisane dane? Ta operacja jest nieodwracalna!')) { 
        localStorage.removeItem('seniorEasy_medications');
        localStorage.removeItem('seniorEasy_familyContacts');
        localStorage.removeItem('seniorEasy_localServices');
        localStorage.removeItem('seniorEasy_emergencySettings');
        localStorage.removeItem('seniorEasy_notifications');
        localStorage.removeItem('seniorEasy_careMode');
        localStorage.removeItem('seniorEasy_news');
        localStorage.removeItem('seniorEasy_lastNewsFetch');
        localStorage.removeItem('seniorEasy_weather');
        localStorage.removeItem('seniorEasy_lastWeatherFetch');
        localStorage.removeItem('seniorEasy_userLocation');
        localStorage.removeItem('seniorEasy_locationAsked');
        
        setMedications([]); 
        setFamilyContacts([]); 
        setLocalServices([]); 
        setNotifications([]); 
        setNews([]);
        setWeather(null);
        setUserLocation(null);
        setCareMode(true);
        setHasAskedForLocation(false);
        
        setEmergencySettings({
          enabled: true,
          position: 'bottom-right',
          size: 70,
          color: 'red',
          pulse: true,
          familyMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy! ProszÄ™ o kontakt.',
          medicalMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy medycznej! ProszÄ™ o natychmiastowy kontakt.',
          servicesMessage: 'ðŸš¨ PILNA WIADOMOÅšÄ†! PotrzebujÄ™ pomocy! ProszÄ™ o kontakt.',
          familyPhones: [],
          medicalPhones: ['112', '999'],
          servicesPhones: ['997', '998']
        });
        
        addNotification('Wszystkie dane zostaÅ‚y wyczyszczone');
      } 
    };

    const unreadNotificationsCount = notifications.filter(n => !n.read).length;

    const markAllNotificationsRead = () => {
      setNotifications(prev => prev.map(n => ({...n, read: true})));
      addNotification('Wszystkie powiadomienia oznaczone jako przeczytane');
    };

    // ========== INICJALIZACJA ==========
    const initFunFacts = () => {
      const facts = [
        "ðŸŒ» UÅ›miech zuÅ¼ywa mniej energii niÅ¼ marszczenie brwi.",
        "ðŸ“š Czytanie przez 6 minut dziennie redukuje stres o 68%.",
        "ðŸš¶â™‚ï¸ Codzienny 30-minutowy spacer moÅ¼e wydÅ‚uÅ¼yÄ‡ Å¼ycie nawet o 7 lat.",
        "ðŸ’§ Picie wody rano poprawia metabolizm o 24%.",
        "ðŸŽµ SÅ‚uchanie muzyki klasycznej poprawia pamiÄ™Ä‡ u seniorÃ³w.",
        "ðŸ§˜â™€ï¸ Medytacja 10 minut dziennie obniÅ¼a ciÅ›nienie krwi.",
        "ðŸŽ Jedzenie jabÅ‚ka dziennie zmniejsza ryzyko wizyt u lekarza.",
        "âœï¸ Pisanie odrÄ™czne Ä‡wiczy mÃ³zg lepiej niÅ¼ pisanie na klawiaturze.",
        "ðŸŒ³ SpÄ™dzanie czasu wÅ›rÃ³d drzew zmniejsza poziom hormonÃ³w stresu.",
        "ðŸ¤ Kontakty spoÅ‚eczne sÄ… kluczowe dla zdrowia psychicznego seniorÃ³w."
      ];
      
      setFunFacts(facts);
      setCurrentFunFact(facts[Math.floor(Math.random() * facts.length)]);
    };

    const loadDataFromStorage = () => {
      try {
        const savedMeds = localStorage.getItem('seniorEasy_medications');
        const savedContacts = localStorage.getItem('seniorEasy_familyContacts');
        const savedServices = localStorage.getItem('seniorEasy_localServices');
        const savedEmergencySettings = localStorage.getItem('seniorEasy_emergencySettings');
        const savedNotifications = localStorage.getItem('seniorEasy_notifications');
        const savedCareMode = localStorage.getItem('seniorEasy_careMode');
        const savedNews = localStorage.getItem('seniorEasy_news');
        const savedWeather = localStorage.getItem('seniorEasy_weather');
        const savedLocation = localStorage.getItem('seniorEasy_userLocation');
        const savedLocationAsked = localStorage.getItem('seniorEasy_locationAsked');
        
        if (savedMeds) setMedications(JSON.parse(savedMeds));
        else setMedications([
          {id:1,name:'Acard',time:'08:00',days:[0,1,2,3,4,5,6],lastTaken:null},
          {id:2,name:'Metformin',time:'12:00',days:[0,1,2,3,4,5,6],lastTaken:null},
          {id:3,name:'Amlozek',time:'20:00',days:[0,1,2,3,4,5,6],lastTaken:null}
        ]);
        
        if (savedContacts) setFamilyContacts(JSON.parse(savedContacts));
        else setFamilyContacts([
          {id:1,name:'Anna (cÃ³rka)',phone:'+48123456789',avatar:'ðŸ‘©',app:'whatsapp'},
          {id:2,name:'Piotr (syn)',phone:'+48987654321',avatar:'ðŸ‘¨',app:'viber'},
          {id:3,name:'Dr. Kowalski',phone:'+48555123456',avatar:'ðŸ‘¨â€âš•ï¸',app:''}
        ]);
        
        if (savedServices) setLocalServices(JSON.parse(savedServices));
        else setLocalServices([
          {id:1,name:'Transport Medyczny',phone:'800123456',icon:'ðŸš‘'},
          {id:2,name:'Pomoc Domowa',phone:'800654321',icon:'ðŸ '},
          {id:3,name:'Apteka z Dowozem',phone:'800789012',icon:'ðŸ’Š'}
        ]);
        
        if (savedEmergencySettings) {
          const parsedSettings = JSON.parse(savedEmergencySettings);
          setEmergencySettings({
            ...parsedSettings,
            familyPhones: parsedSettings.familyPhones || [],
            medicalPhones: parsedSettings.medicalPhones || ['112', '999'],
            servicesPhones: parsedSettings.servicesPhones || ['997', '998']
          });
        }
        
        if (savedNotifications) setNotifications(JSON.parse(savedNotifications));
        if (savedCareMode !== null) setCareMode(savedCareMode === 'true');
        if (savedNews) setNews(JSON.parse(savedNews));
        if (savedWeather) setWeather(JSON.parse(savedWeather));
        
        if (savedLocation) {
          const { latitude, longitude } = JSON.parse(savedLocation);
          setUserLocation({ latitude, longitude });
        }
        
        if (savedLocationAsked === 'true') setHasAskedForLocation(true);
        
      } catch (error) {
        console.error('BÅ‚Ä…d Å‚adowania danych z localStorage:', error);
        setMedications([
          {id:1,name:'Acard',time:'08:00',days:[0,1,2,3,4,5,6],lastTaken:null},
          {id:2,name:'Metformin',time:'12:00',days:[0,1,2,3,4,5,6],lastTaken:null},
          {id:3,name:'Amlozek',time:'20:00',days:[0,1,2,3,4,5,6],lastTaken:null}
        ]);
        setFamilyContacts([
          {id:1,name:'Anna (cÃ³rka)',phone:'+48123456789',avatar:'ðŸ‘©',app:'whatsapp'},
          {id:2,name:'Piotr (syn)',phone:'+48987654321',avatar:'ðŸ‘¨',app:'viber'},
          {id:3,name:'Dr. Kowalski',phone:'+48555123456',avatar:'ðŸ‘¨â€âš•ï¸',app:''}
        ]);
        setLocalServices([
          {id:1,name:'Transport Medyczny',phone:'800123456',icon:'ðŸš‘'},
          {id:2,name:'Pomoc Domowa',phone:'800654321',icon:'ðŸ '},
          {id:3,name:'Apteka z Dowozem',phone:'800789012',icon:'ðŸ’Š'}
        ]);
      }
    };

    useEffect(() => {
      // Inicjalizacja danych
      loadDataFromStorage();
      setTimeout(() => setIsLoading(false), 800);
      initFunFacts();
      
      // Event listeners dla PWA
      const handleBeforeInstallPrompt = (e) => { 
        e.preventDefault(); 
        setDeferredPrompt(e); 
        setIsInstallable(true);
        setShowInstallPrompt(true); 
      };

      const handleAppInstalled = () => {
        setDeferredPrompt(null);
        setIsInstallable(false);
        setShowInstallPrompt(false);
        addNotification('Aplikacja zostaÅ‚a pomyÅ›lnie zainstalowana!');
      };

      if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
        setIsInstallable(false);
        setShowInstallPrompt(false);
      }

      window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
      window.addEventListener('appinstalled', handleAppInstalled);

      // Ustaw przypomnienia o lekach
      const reminderInterval = setInterval(() => {
        checkMedicationReminders();
      }, 60000);

      checkMedicationReminders();

      // ZaÅ‚aduj wiadomoÅ›ci
      if (news.length === 0) {
        fetchNews();
      }
      
      // SprawdÅº status pozwolenia na lokalizacjÄ™
      checkLocationPermission();
      
      // JeÅ›li nie ma pogody, sprÃ³buj pobraÄ‡
      if (!weather) {
        setTimeout(() => {
          if (!userLocation && !hasAskedForLocation) {
            const savedLocation = localStorage.getItem('seniorEasy_userLocation');
            if (savedLocation) {
              const { latitude, longitude } = JSON.parse(savedLocation);
              setUserLocation({ latitude, longitude });
              fetchWeather(latitude, longitude);
            } else {
              setTimeout(() => {
                if (locationPermission !== 'denied' && !hasAskedForLocation) {
                  getUserLocation();
                } else {
                  fetchWeather(52.2297, 21.0122);
                }
              }, 2000);
            }
          }
        }, 1000);
      }

      // OdÅ›wieÅ¼aj ciekawostkÄ™ co godzinÄ™
      const factInterval = setInterval(() => {
        if (funFacts.length > 0) {
          const randomIndex = Math.floor(Math.random() * funFacts.length);
          setCurrentFunFact(funFacts[randomIndex]);
        }
      }, 3600000);

      // OdÅ›wieÅ¼aj wiadomoÅ›ci co 30 minut
      const newsInterval = setInterval(() => {
        fetchNews();
      }, 30 * 60 * 1000);

      // OdÅ›wieÅ¼aj pogodÄ™ co godzinÄ™
      const weatherInterval = setInterval(() => {
        if (userLocation) {
          fetchWeather(userLocation.latitude, userLocation.longitude);
        } else if (locationPermission === 'granted' && !hasAskedForLocation) {
          getUserLocation();
        } else if (!hasAskedForLocation) {
          fetchWeather(52.2297, 21.0122);
        }
      }, 60 * 60 * 1000);

      return () => {
        clearInterval(reminderInterval);
        clearInterval(factInterval);
        clearInterval(newsInterval);
        clearInterval(weatherInterval);
        window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
        window.removeEventListener('appinstalled', handleAppInstalled);
      };
    }, [userLocation, funFacts.length, locationPermission, hasAskedForLocation]);

    // Zapisywanie danych do localStorage
    useEffect(() => { 
      if (medications.length > 0) {
        localStorage.setItem('seniorEasy_medications', JSON.stringify(medications));
      }
    }, [medications]);
    
    useEffect(() => { 
      if (familyContacts.length > 0) {
        localStorage.setItem('seniorEasy_familyContacts', JSON.stringify(familyContacts));
      }
    }, [familyContacts]);
    
    useEffect(() => { 
      if (localServices.length > 0) {
        localStorage.setItem('seniorEasy_localServices', JSON.stringify(localServices));
      }
    }, [localServices]);
    
    useEffect(() => { 
      localStorage.setItem('seniorEasy_emergencySettings', JSON.stringify(emergencySettings));
    }, [emergencySettings]);
    
    useEffect(() => { 
      localStorage.setItem('seniorEasy_notifications', JSON.stringify(notifications));
    }, [notifications]);
    
    useEffect(() => { 
      localStorage.setItem('seniorEasy_careMode', careMode.toString());
    }, [careMode]);

    useEffect(() => {
      if (userLocation) {
        localStorage.setItem('seniorEasy_userLocation', JSON.stringify(userLocation));
      }
    }, [userLocation]);

    // ========== KOMPONENTY RENDERUJÄ„CE ==========
    const renderWeatherWidget = () => {
      return React.createElement('div', { className: 'bg-gradient-to-r from-blue-400 to-blue-600 text-white p-4 md:p-6 rounded-3xl shadow-xl mb-4' },
        React.createElement('div', { className: 'flex justify-between items-center mb-4' },
          React.createElement('h3', { className: 'text-2xl md:text-3xl font-bold' }, 'ðŸŒ¤ï¸ Pogoda'),
          React.createElement('div', { className: 'flex space-x-2' },
            locationPermission === 'granted' && userLocation && 
            React.createElement('button', {
              onClick: () => refreshWeatherManually(),
              className: 'bg-white text-blue-600 hover:bg-blue-50 px-3 py-2 rounded-2xl font-bold flex items-center text-sm',
              title: 'OdÅ›wieÅ¼ pogodÄ™'
            }, 'ðŸ”„'),
            !hasAskedForLocation && !userLocation &&
            React.createElement('button', {
              onClick: () => getUserLocation(),
              className: 'bg-white text-blue-600 hover:bg-blue-50 px-3 py-2 rounded-2xl font-bold flex items-center text-sm',
              title: 'UÅ¼yj mojej lokalizacji'
            }, 'ðŸ“')
          )
        ),
        
        weatherLoading ? 
          React.createElement('div', { className: 'text-center py-6' },
            React.createElement('div', { className: 'loading-spinner mx-auto mb-4 border-white' }),
            React.createElement('p', null, 'Pobieram aktualnÄ… pogodÄ™...')
          )
        : weather ?
          React.createElement('div', null,
            React.createElement('div', { className: 'flex items-center justify-between mb-4' },
              React.createElement('div', null,
                React.createElement('div', { className: 'text-5xl md:text-6xl font-bold mb-2' }, `${weather.temperature}Â°C`),
                React.createElement('div', { className: 'text-xl' }, weather.city),
                React.createElement('div', { className: 'text-lg opacity-90' }, `Odczuwalna: ${weather.feels_like}Â°C`),
                locationPermission === 'granted' && userLocation &&
                React.createElement('div', { className: 'text-sm opacity-75 mt-1' }, 'ðŸ“ Twoja lokalizacja')
              ),
              React.createElement('div', { className: 'text-center' },
                React.createElement('div', { className: 'weather-icon' }, weather.icon),
                React.createElement('div', { className: 'text-xl font-bold' }, weather.description)
              )
            ),
            
            React.createElement('div', { className: 'bg-white bg-opacity-20 p-3 rounded-2xl mb-4' },
              React.createElement('div', { className: 'flex justify-between items-center mb-2' },
                React.createElement('span', null, 'ðŸ’§ WilgotnoÅ›Ä‡'),
                React.createElement('span', { className: 'font-bold' }, `${weather.humidity}%`)
              ),
              React.createElement('div', { className: 'text-sm opacity-90' }, 'Optymalna dla zdrowia')
            ),
            
            React.createElement('div', null,
              React.createElement('h4', { className: 'text-lg font-bold mb-3' }, 'Prognoza na 3 dni'),
              React.createElement('div', { className: 'grid grid-cols-3 gap-2' },
                weather.forecast.map((day, index) =>
                  React.createElement('div', {
                    key: index,
                    className: 'bg-white bg-opacity-20 p-2 rounded-2xl text-center'
                  },
                    React.createElement('div', { className: 'font-bold mb-1 text-sm' }, day.day),
                    React.createElement('div', { className: 'text-2xl mb-1' }, day.icon),
                    React.createElement('div', { className: 'text-lg font-bold' }, `${day.temp}Â°C`)
                  )
                )
              )
            )
          )
        :
          React.createElement('div', { className: 'text-center py-6' },
            React.createElement('p', { className: 'text-xl mb-4' }, 'Nie udaÅ‚o siÄ™ pobraÄ‡ pogody'),
            !hasAskedForLocation &&
            React.createElement('button', {
              onClick: () => getUserLocation(),
              className: 'bg-white text-blue-600 px-4 py-2 rounded-2xl font-bold text-sm'
            }, 'ðŸ“ UÅ¼yj mojej lokalizacji')
          )
      );
    };

    const renderNewsWidget = () => {
      return React.createElement('div', { className: 'bg-gradient-to-r from-purple-500 to-pink-500 text-white p-4 md:p-6 rounded-3xl shadow-xl mb-4' },
        React.createElement('div', { className: 'flex justify-between items-center mb-4' },
          React.createElement('h3', { className: 'text-2xl md:text-3xl font-bold' }, 'ðŸ“° AktualnoÅ›ci'),
          React.createElement('button', {
            onClick: refreshNewsManually,
            className: 'bg-white text-purple-600 hover:bg-purple-50 px-4 py-2 rounded-2xl font-bold flex items-center',
            disabled: newsLoading
          },
            newsLoading ? 'Åadowanie...' : 'ðŸ”„ OdÅ›wieÅ¼'
          )
        ),
        
        newsLoading ?
          React.createElement('div', { className: 'text-center py-6' },
            React.createElement('div', { className: 'loading-spinner mx-auto mb-4 border-white' }),
            React.createElement('p', null, 'ÅadujÄ™ aktualnoÅ›ci...')
          )
        : news.length > 0 ?
          React.createElement('div', { className: 'space-y-3' },
            news.slice(0, 3).map(item =>
              React.createElement('div', {
                key: item.id,
                className: 'news-item'
              },
                React.createElement('div', { className: 'flex justify-between items-start mb-2' },
                  React.createElement('span', { className: 'bg-white bg-opacity-30 px-2 py-1 rounded-full text-xs' }, item.category),
                  React.createElement('span', { className: 'text-xs opacity-80' }, item.time)
                ),
                React.createElement('h4', { className: 'text-lg font-bold mb-1' }, item.title),
                React.createElement('p', { className: 'opacity-90 text-xs' }, item.description),
                React.createElement('div', { className: 'text-xs opacity-70 mt-1' }, `Å¹rÃ³dÅ‚o: ${item.source}`)
              )
            ),
            React.createElement('button', {
              onClick: () => setCurrentScreen('news'),
              className: 'w-full bg-white text-purple-600 hover:bg-purple-50 py-2 rounded-2xl font-bold mt-3 text-sm'
            }, 'Zobacz wszystkie aktualnoÅ›ci')
          )
        :
          React.createElement('div', { className: 'text-center py-6' },
            React.createElement('p', { className: 'text-xl' }, 'Brak dostÄ™pnych aktualnoÅ›ci')
          )
      );
    };

    const renderFunFactWidget = () => {
      return React.createElement('div', { className: 'fun-fact p-4 md:p-6 rounded-3xl shadow-xl mb-4' },
        React.createElement('div', { className: 'flex items-center mb-3' },
          React.createElement('span', { className: 'text-2xl mr-3' }, 'ðŸ’¡'),
          React.createElement('h3', { className: 'text-xl md:text-2xl font-bold text-gray-800' }, 'Ciekawostka dnia')
        ),
        
        React.createElement('div', { className: 'text-base md:text-lg text-gray-700 italic mb-3' },
          currentFunFact || 'Åadowanie ciekawostki...'
        ),
        
        React.createElement('div', { className: 'flex justify-between' },
          React.createElement('button', {
            onClick: () => {
              if (funFacts.length > 0) {
                const randomIndex = Math.floor(Math.random() * funFacts.length);
                setCurrentFunFact(funFacts[randomIndex]);
              }
            },
            className: 'bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-2xl font-bold text-sm'
          }, 'ðŸŽ² Nowa ciekawostka'),
          
          React.createElement('button', {
            onClick: () => {
              if (currentFunFact && navigator.share) {
                navigator.share({
                  title: 'Ciekawostka Senior-Easy',
                  text: currentFunFact,
                  url: window.location.href
                });
              } else if (currentFunFact) {
                navigator.clipboard.writeText(currentFunFact);
                console.log('Ciekawostka skopiowana do schowka');
              }
            },
            className: 'bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-2xl font-bold text-sm'
          }, 'ðŸ“‹ UdostÄ™pnij')
        )
      );
    };

    const renderHomeScreen = () => {
      return React.createElement('div', { className: 'space-y-4 sm:space-y-6' },
        React.createElement('div', { className: 'text-center' },
          React.createElement('h1', { className: 'text-3xl sm:text-4xl md:text-5xl font-bold text-blue-600 mb-2' }, 'Senior-Easy'),
          React.createElement('p', { className: 'text-lg sm:text-xl md:text-2xl text-gray-600 mb-4' }, 'Witaj! Co chcesz zrobiÄ‡?')
        ),
        
        React.createElement('div', { className: 'grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4 md:gap-6' },
          React.createElement('button', {
            onClick: () => setCurrentScreen('video'),
            className: 'bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-6 sm:p-6 md:p-8 rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col items-center justify-center space-y-2 sm:space-y-3 md:space-y-4 transition-colors min-h-[140px] sm:min-h-[160px]'
          },
            React.createElement('span', { className: 'text-4xl sm:text-5xl' }, 'ðŸ“¹'),
            React.createElement('span', { className: 'text-xl sm:text-2xl md:text-3xl font-bold' }, 'Rozmowa Wideo')
          ),
          React.createElement('button', {
            onClick: () => setCurrentScreen('medications'),
            className: 'bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white p-6 sm:p-6 md:p-8 rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col items-center justify-center space-y-2 sm:space-y-3 md:space-y-4 transition-colors min-h-[140px] sm:min-h-[160px]'
          },
            React.createElement('span', { className: 'text-4xl sm:text-5xl' }, 'ðŸ’Š'),
            React.createElement('span', { className: 'text-xl sm:text-2xl md:text-3xl font-bold' }, 'Leki')
          ),
          React.createElement('button', {
            onClick: () => setCurrentScreen('contacts'),
            className: 'bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white p-6 sm:p-6 md:p-8 rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col items-center justify-center space-y-2 sm:space-y-3 md:space-y-4 transition-colors min-h-[140px] sm:min-h-[160px]'
          },
            React.createElement('span', { className: 'text-4xl sm:text-5xl' }, 'ðŸ“ž'),
            React.createElement('span', { className: 'text-xl sm:text-2xl md:text-3xl font-bold' }, 'Rodzina')
          ),
          React.createElement('button', {
            onClick: () => setCurrentScreen('services'),
            className: 'bg-orange-500 hover:bg-orange-600 active:bg-orange-700 text-white p-6 sm:p-6 md:p-8 rounded-2xl sm:rounded-3xl shadow-2xl flex flex-col items-center justify-center space-y-2 sm:space-y-3 md:space-y-4 transition-colors min-h-[140px] sm:min-h-[160px]'
          },
            React.createElement('span', { className: 'text-4xl sm:text-5xl' }, 'ðŸ“'),
            React.createElement('span', { className: 'text-xl sm:text-2xl md:text-3xl font-bold' }, 'UsÅ‚ugi')
          )
        ),
        
        // Widgety na dole ekranu gÅ‚Ã³wnego
        React.createElement('div', { className: 'mt-6 pt-6 border-t border-gray-300' },
          React.createElement('h3', { className: 'text-2xl font-bold text-center mb-4 text-gray-700' }, 'Informacje i aktualnoÅ›ci'),
          React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-3 gap-4' },
            renderWeatherWidget(),
            renderNewsWidget(),
            renderFunFactWidget()
          )
        )
      );
    };

    const renderVideoScreen = () => {
      return React.createElement('div', { className: 'space-y-4 md:space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Rozmowa Wideo'),
        familyContacts.map(c => 
          React.createElement('button', {
            key: c.id,
            onClick: () => startVideoCall(c),
            className: 'w-full bg-white hover:bg-green-50 active:bg-green-100 border-4 border-green-500 p-6 md:p-8 rounded-3xl shadow-xl flex items-center space-x-4 md:space-x-6 mb-4 transition-colors'
          },
            React.createElement('span', { className: 'text-5xl md:text-6xl' }, c.avatar),
            React.createElement('div', { className: 'flex-1 text-left' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, c.name),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-500' }, c.phone),
              React.createElement('div', { className: 'text-base md:text-lg text-gray-400' }, c.app ? `(${c.app})` : '')
            ),
            React.createElement('span', { className: 'text-4xl md:text-5xl' }, 'ðŸ“¹')
          )
        )
      );
    };

    const renderMedicationsScreen = () => {
      return React.createElement('div', { className: 'space-y-4 md:space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Przypomnienia o Lekach'),
        
        medications.length === 0 ? 
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'text-6xl mb-4' }, 'ðŸ’Š'),
            React.createElement('p', { className: 'text-2xl text-gray-600 mb-2' }, 'Brak zapisanych lekÃ³w'),
            React.createElement('p', { className: 'text-lg text-gray-500' }, 'Dodaj swoje leki korzystajÄ…c z formularza poniÅ¼ej')
          )
        :
          medications.map(med => {
            const today = (new Date().getDay() + 6) % 7;
            const isTodayScheduled = med.days.includes(today);
            const wasTakenToday = med.lastTaken === new Date().toDateString();
            const isAvailable = isTodayScheduled && !wasTakenToday;
            
            return React.createElement('div', {
              key: med.id,
              className: `bg-white border-4 p-4 md:p-6 rounded-3xl shadow-xl flex items-center justify-between ${!isAvailable?'border-gray-300 opacity-60':'border-purple-500'}`
            },
              editingMedication === med.id ? 
                React.createElement('div', { className: 'w-full space-y-4' },
                  React.createElement('input', {
                    type: 'text',
                    placeholder: 'Nazwa leku',
                    value: newMedName,
                    onChange: e => setNewMedName(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('input', {
                    type: 'time',
                    value: newMedTime,
                    onChange: e => setNewMedTime(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('div', { className: 'flex flex-col space-y-3' },
                    React.createElement('div', { className: 'flex justify-between' },
                      React.createElement('span', { className: 'text-lg font-bold' }, 'Dni przyjmowania:'),
                      React.createElement('div', { className: 'flex space-x-2' },
                        React.createElement('button', {
                          onClick: selectAllDays,
                          className: 'bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-sm'
                        }, 'Wszystkie'),
                        React.createElement('button', {
                          onClick: clearDays,
                          className: 'bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded text-sm'
                        }, 'WyczyÅ›Ä‡')
                      )
                    ),
                    React.createElement('div', { className: 'flex justify-between' },
                      weekdays.map((day, index) =>
                        React.createElement('button', {
                          key: index,
                          onClick: () => toggleDay(index),
                          className: `weekday-button ${newMedDays.includes(index) ? 'selected' : ''}`
                        }, day)
                      )
                    )
                  ),
                  React.createElement('div', { className: 'flex space-x-3' },
                    React.createElement('button', {
                      onClick: () => saveEditMedication(med.id),
                      className: 'flex-1 bg-green-500 hover:bg-green-600 text-white p-3 rounded-2xl font-bold'
                    }, 'ðŸ’¾ Zapisz'),
                    React.createElement('button', {
                      onClick: cancelEditMedication,
                      className: 'flex-1 bg-gray-500 hover:bg-gray-600 text-white p-3 rounded-2xl font-bold'
                    }, 'âŒ Anuluj')
                  )
                )
              :
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: 'flex-1' },
                    React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, med.name),
                    React.createElement('div', { className: 'text-xl md:text-2xl text-gray-600' }, `Godzina: ${med.time}`),
                    React.createElement('div', { className: 'mt-2' },
                      React.createElement('div', { className: 'text-lg text-gray-500' }, 'Dni:'),
                      React.createElement('div', { className: 'flex space-x-1' },
                        weekdays.map((day, index) =>
                          React.createElement('span', {
                            key: index,
                            className: `text-sm ${med.days.includes(index) ? 'font-bold text-purple-600' : 'text-gray-400'}`
                          }, day)
                        )
                      )
                    )
                  ),
                  React.createElement('div', { className: 'flex space-x-2 md:space-x-3' },
                    isAvailable ? 
                      React.createElement('button', {
                        onClick: () => markMedicationTaken(med.id),
                        className: 'bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-2xl'
                      }, 'âœ…')
                    :
                      React.createElement('div', { 
                        className: 'bg-gray-300 text-white p-3 md:p-4 rounded-2xl text-2xl',
                        title: wasTakenToday ? 'PrzyjÄ™ty dzisiaj' : 'Nie zaplanowany na dzisiaj'
                      }, 'âœ…'),
                    React.createElement('button', {
                      onClick: () => startEditMedication(med),
                      className: 'bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-2xl'
                    }, 'âœï¸'),
                    React.createElement('button', {
                      onClick: () => deleteMedication(med.id),
                      className: 'bg-red-500 hover:bg-red-600 active:bg-red-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-2xl'
                    }, 'ðŸ—‘ï¸')
                  )
                )
            );
          }),

        React.createElement('div', { className: 'bg-blue-50 border-4 border-blue-300 p-4 md:p-6 rounded-3xl space-y-4' },
          React.createElement('h3', { className: 'text-xl md:text-2xl font-bold text-center' }, 'Dodaj Nowy Lek'),
          React.createElement('input', {
            type: 'text',
            placeholder: 'Nazwa leku',
            value: newMedName,
            onChange: e => setNewMedName(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('input', {
            type: 'time',
            value: newMedTime,
            onChange: e => setNewMedTime(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('div', { className: 'flex flex-col space-y-3' },
            React.createElement('div', { className: 'flex justify-between' },
              React.createElement('span', { className: 'text-lg font-bold' }, 'Dni przyjmowania:'),
              React.createElement('div', { className: 'flex space-x-2' },
                React.createElement('button', {
                  onClick: selectAllDays,
                  className: 'bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-sm'
                }, 'Wszystkie'),
                React.createElement('button', {
                  onClick: clearDays,
                  className: 'bg-gray-500 hover:bg-gray-600 text-white px-2 py-1 rounded text-sm'
                }, 'WyczyÅ›Ä‡')
              )
            ),
            React.createElement('div', { className: 'flex justify-between' },
              weekdays.map((day, index) =>
                React.createElement('button', {
                  key: index,
                  onClick: () => toggleDay(index),
                  className: `weekday-button ${newMedDays.includes(index) ? 'selected' : ''}`
                }, day)
              )
            )
          ),
          React.createElement('button', {
            onClick: addMedication,
            className: 'w-full bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white text-xl md:text-2xl font-bold p-3 md:p-4 rounded-2xl transition-colors'
          }, 'âž• Dodaj')
        )
      );
    };
  
    const renderContactsScreen = () => {
      return React.createElement('div', { className: 'space-y-4 md:space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Kontakty Rodzinne'),
        
        familyContacts.length === 0 ?
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'text-6xl mb-4' }, 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦'),
            React.createElement('p', { className: 'text-2xl text-gray-600 mb-2' }, 'Brak zapisanych kontaktÃ³w'),
            React.createElement('p', { className: 'text-lg text-gray-500' }, 'Dodaj czÅ‚onkÃ³w rodziny korzystajÄ…c z formularza poniÅ¼ej')
          )
        :
          familyContacts.map(c =>
            React.createElement('div', {
              key: c.id,
              className: 'bg-white border-4 border-blue-500 p-4 md:p-6 rounded-3xl shadow-xl mb-4'
            },
              editingContact === c.id ?
                React.createElement('div', { className: 'space-y-4' },
                  React.createElement('input', {
                    type: 'text',
                    placeholder: 'ImiÄ™ i nazwisko',
                    value: newContactName,
                    onChange: e => setNewContactName(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('input', {
                    type: 'tel',
                    placeholder: 'Numer telefonu z +48',
                    value: newContactPhone,
                    onChange: e => setNewContactPhone(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('select', {
                    value: newContactApp,
                    onChange: e => setNewContactApp(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  },
                    React.createElement('option', { value: '' }, 'Brak aplikacji'),
                    React.createElement('option', { value: 'whatsapp' }, 'WhatsApp'),
                    React.createElement('option', { value: 'viber' }, 'Viber')
                  ),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3' },
                    React.createElement('button', {
                      onClick: () => saveEditContact(c.id),
                      className: 'flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'ðŸ’¾ Zapisz'),
                    React.createElement('button', {
                      onClick: cancelEditContact,
                      className: 'flex-1 bg-gray-500 hover:bg-gray-600 active:bg-gray-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'âŒ Anuluj')
                  )
                )
              :
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: 'flex items-center space-x-4 md:space-x-6 mb-4' },
                    React.createElement('span', { className: 'text-5xl md:text-6xl' }, c.avatar),
                    React.createElement('div', { className: 'flex-1' },
                      React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, c.name),
                      React.createElement('div', { className: 'text-lg md:text-xl text-gray-500' }, c.phone),
                      React.createElement('div', { className: 'text-base md:text-lg text-gray-400' }, c.app ? `(${c.app})` : '')
                    )
                  ),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3' },
                    React.createElement('button', {
                      onClick: () => makeCall(c),
                      className: 'flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-3 md:p-4 rounded-2xl flex items-center justify-center transition-colors text-lg'
                    }, 'ðŸ“ž ZadzwoÅ„'),
                    React.createElement('button', {
                      onClick: () => startVideoCall(c),
                      className: 'flex-1 bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white p-3 md:p-4 rounded-2xl flex items-center justify-center transition-colors text-lg'
                    }, 'ðŸŽ¥ Wideo')
                  ),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3 mt-3' },
                    React.createElement('button', {
                      onClick: () => startEditContact(c),
                      className: 'flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'âœï¸ Edytuj'),
                    React.createElement('button', {
                      onClick: () => deleteContact(c.id),
                      className: 'flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'ðŸ—‘ï¸ UsuÅ„')
                  )
                )
            )
          ),

        React.createElement('div', { className: 'bg-blue-50 border-4 border-blue-300 p-4 md:p-6 rounded-3xl space-y-4' },
          React.createElement('h3', { className: 'text-xl md:text-2xl font-bold text-center' }, 'Dodaj Kontakt'),
          React.createElement('input', {
            type: 'text',
            placeholder: 'ImiÄ™ i nazwisko',
            value: newContactName,
            onChange: e => setNewContactName(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('input', {
            type: 'tel',
            placeholder: 'Numer telefonu z +48',
            value: newContactPhone,
            onChange: e => setNewContactPhone(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('select', {
            value: newContactApp,
            onChange: e => setNewContactApp(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          },
            React.createElement('option', { value: '' }, 'Brak aplikacji'),
            React.createElement('option', { value: 'whatsapp' }, 'WhatsApp'),
            React.createElement('option', { value: 'viber' }, 'Viber')
          ),
          React.createElement('button', {
            onClick: addContact,
            className: 'w-full bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white text-xl md:text-2xl font-bold p-3 md:p-4 rounded-2xl transition-colors'
          }, 'âž• Dodaj Kontakt')
        )
      );
    };

    const renderServicesScreen = () => {
      return React.createElement('div', { className: 'space-y-4 md:space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Lokalne UsÅ‚ugi'),
        
        localServices.length === 0 ?
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'text-6xl mb-4' }, 'ðŸ¢'),
            React.createElement('p', { className: 'text-2xl text-gray-600 mb-2' }, 'Brak zapisanych usÅ‚ug'),
            React.createElement('p', { className: 'text-lg text-gray-500' }, 'Dodaj lokalne usÅ‚ugi korzystajÄ…c z formularza poniÅ¼ej')
          )
        :
          localServices.map(s =>
            React.createElement('div', {
              key: s.id,
              className: 'bg-white border-4 border-orange-500 p-4 md:p-6 rounded-3xl shadow-xl mb-4'
            },
              editingService === s.id ?
                React.createElement('div', { className: 'space-y-4' },
                  React.createElement('input', {
                    type: 'text',
                    placeholder: 'Nazwa',
                    value: newServiceName,
                    onChange: e => setNewServiceName(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('input', {
                    type: 'tel',
                    placeholder: 'Telefon',
                    value: newServicePhone,
                    onChange: e => setNewServicePhone(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('input', {
                    type: 'text',
                    placeholder: 'Emoji/Ikona',
                    value: newServiceIcon,
                    onChange: e => setNewServiceIcon(e.target.value),
                    className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
                  }),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3' },
                    React.createElement('button', {
                      onClick: () => saveEditService(s.id),
                      className: 'flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'ðŸ’¾ Zapisz'),
                    React.createElement('button', {
                      onClick: cancelEditService,
                      className: 'flex-1 bg-gray-500 hover:bg-gray-600 active:bg-gray-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'âŒ Anuluj')
                  )
                )
              :
                React.createElement(React.Fragment, null,
                  React.createElement('div', { className: 'flex items-center space-x-4 md:space-x-6 mb-4' },
                    React.createElement('span', { className: 'text-5xl md:text-6xl' }, s.icon),
                    React.createElement('div', { className: 'flex-1 text-left' },
                      React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, s.name),
                      React.createElement('div', { className: 'text-lg md:text-xl text-gray-500' }, s.phone)
                    )
                  ),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3' },
                    React.createElement('button', {
                      onClick: () => makeCall(s),
                      className: 'flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white p-3 md:p-4 rounded-2xl flex items-center justify-center transition-colors text-lg'
                    }, 'ðŸ“ž ZadzwoÅ„')
                  ),
                  React.createElement('div', { className: 'flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-3 mt-3' },
                    React.createElement('button', {
                      onClick: () => startEditService(s),
                      className: 'flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'âœï¸ Edytuj'),
                    React.createElement('button', {
                      onClick: () => deleteService(s.id),
                      className: 'flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white p-3 md:p-4 rounded-2xl transition-colors text-lg'
                    }, 'ðŸ—‘ï¸ UsuÅ„')
                  )
                )
            )
          ),

        React.createElement('div', { className: 'bg-orange-50 border-4 border-orange-300 p-4 md:p-6 rounded-3xl space-y-4' },
          React.createElement('h3', { className: 'text-xl md:text-2xl font-bold text-center' }, 'Dodaj UsÅ‚ugÄ™'),
          React.createElement('input', {
            type: 'text',
            placeholder: 'Nazwa',
            value: newServiceName,
            onChange: e => setNewServiceName(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('input', {
            type: 'tel',
            placeholder: 'Telefon',
            value: newServicePhone,
            onChange: e => setNewServicePhone(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('input', {
            type: 'text',
            placeholder: 'Emoji/Ikona',
            value: newServiceIcon,
            onChange: e => setNewServiceIcon(e.target.value),
            className: 'w-full text-xl md:text-2xl p-3 md:p-4 border-2 border-gray-300 rounded-2xl'
          }),
          React.createElement('button', {
            onClick: addService,
            className: 'w-full bg-orange-500 hover:bg-orange-600 active:bg-orange-700 text-white text-xl md:text-2xl font-bold p-3 md:p-4 rounded-2xl transition-colors'
          }, 'âž• Dodaj UsÅ‚ugÄ™')
        )
      );
    };

    const renderNotificationsScreen = () => {
      return React.createElement('div', { className: 'space-y-4 md:space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Powiadomienia'),
        
        React.createElement('div', { className: 'bg-blue-50 border-4 border-blue-300 p-4 rounded-3xl' },
          React.createElement('div', { className: 'flex justify-between items-center mb-3' },
            React.createElement('div', { className: 'text-lg font-bold text-gray-800' },
              `ÅÄ…cznie: ${notifications.length} powiadomieÅ„`
            ),
            React.createElement('div', { className: 'text-lg font-bold text-orange-600' },
              `Nieprzeczytane: ${unreadNotificationsCount}`
            )
          ),
          
          notifications.length > 0 && React.createElement('div', { className: 'grid grid-cols-1 sm:grid-cols-2 gap-2' },
            React.createElement('button', {
              onClick: markAllNotificationsRead,
              className: 'bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-2xl font-bold flex items-center justify-center space-x-2'
            },
              React.createElement('span', null, 'ðŸ“–'),
              React.createElement('span', null, 'Oznacz jako przeczytane')
            ),
            React.createElement('button', {
              onClick: () => {
                if (notifications.length === 0) return;
                if (confirm(`Czy na pewno chcesz usunÄ…Ä‡ wszystkie powiadomienia (${notifications.length})?`)) {
                  setNotifications([]);
                  addNotification('Wszystkie powiadomienia zostaÅ‚y wyczyszczone');
                }
              },
              className: 'bg-red-500 hover:bg-red-600 text-white p-3 rounded-2xl font-bold flex items-center justify-center space-x-2'
            },
              React.createElement('span', null, 'ðŸ—‘ï¸'),
              React.createElement('span', null, 'WyczyÅ›Ä‡ wszystkie')
            )
          )
        ),
        
        notifications.length === 0 ?
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'text-6xl mb-4' }, 'ðŸ“­'),
            React.createElement('p', { className: 'text-2xl text-gray-500 mb-2' }, 'Brak powiadomieÅ„'),
            React.createElement('p', { className: 'text-lg text-gray-400' }, 'Tutaj pojawiÄ… siÄ™ przypomnienia o lekach i inne informacje')
          )
        :
          React.createElement('div', { className: 'space-y-4' },
            notifications.map(notif =>
              React.createElement('div', {
                key: notif.id,
                className: `bg-white border-4 p-4 md:p-6 rounded-3xl shadow-xl transition-all duration-300 ${
                  notif.read ? 'border-gray-300 opacity-75' : 'border-yellow-400'
                }`
              },
                React.createElement('div', { className: 'flex justify-between items-start' },
                  React.createElement('div', { className: 'flex-1' },
                    React.createElement('p', { className: `text-lg md:text-xl ${notif.read ? 'text-gray-600' : 'text-gray-800 font-bold'}` }, notif.text),
                    React.createElement('p', { className: 'text-sm text-gray-500 mt-2 flex items-center space-x-2' },
                      React.createElement('span', null, 'ðŸ•’'),
                      React.createElement('span', null, notif.time)
                    )
                  ),
                  React.createElement('div', { className: 'flex flex-col space-y-2 ml-4' },
                    !notif.read && React.createElement('span', { 
                      className: 'bg-yellow-400 text-white px-3 py-1 rounded-full text-sm font-bold animate-pulse'
                    }, 'NOWE'),
                    React.createElement('button', {
                      onClick: () => {
                        if (confirm('Czy na pewno chcesz usunÄ…Ä‡ to powiadomienie?')) {
                          setNotifications(prev => prev.filter(notification => notification.id !== notif.id));
                        }
                      },
                      className: 'bg-red-500 hover:bg-red-600 text-white p-2 rounded-full text-sm transition-colors'
                    }, 'ðŸ—‘ï¸')
                  )
                )
              )
            )
          )
      );
    };

    const renderNewsScreen = () => {
      return React.createElement('div', { className: 'space-y-6' },
        React.createElement('div', { className: 'flex items-center justify-between mb-6' },
          React.createElement('button', {
            onClick: () => setCurrentScreen('home'),
            className: 'bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-2xl'
          }, 'â† WrÃ³Ä‡'),
          React.createElement('h2', { className: 'text-3xl font-bold text-center flex-1' }, 'ðŸ“° Wszystkie AktualnoÅ›ci'),
          React.createElement('button', {
            onClick: refreshNewsManually,
            className: 'bg-purple-500 hover:bg-purple-600 text-white p-3 rounded-2xl',
            disabled: newsLoading
          }, newsLoading ? '...' : 'ðŸ”„')
        ),
        
        newsLoading ?
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'loading-spinner mx-auto mb-4' }),
            React.createElement('p', { className: 'text-xl' }, 'Åadowanie aktualnoÅ›ci...')
          )
        : news.length > 0 ?
          React.createElement('div', { className: 'space-y-4' },
            news.map(item =>
              React.createElement('div', {
                key: item.id,
                className: 'bg-white border-4 border-purple-200 p-6 rounded-3xl shadow-lg'
              },
                React.createElement('div', { className: 'flex justify-between items-center mb-3' },
                  React.createElement('span', { className: 'bg-purple-100 text-purple-800 px-3 py-1 rounded-full font-bold' }, item.category),
                  React.createElement('div', { className: 'text-gray-500 text-sm' },
                    React.createElement('span', { className: 'mr-3' }, `ðŸ•’ ${item.time}`),
                    React.createElement('span', null, `ðŸ“° ${item.source}`)
                  )
                ),
                React.createElement('h3', { className: 'text-2xl font-bold text-gray-800 mb-3' }, item.title),
                React.createElement('p', { className: 'text-gray-600 mb-4' }, item.description),
                React.createElement('button', {
                  onClick: () => openFullNews(item),
                  className: 'w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-2xl font-bold'
                }, 'ðŸ“– Czytaj wiÄ™cej')
              )
            )
          )
        :
          React.createElement('div', { className: 'text-center py-12' },
            React.createElement('div', { className: 'text-6xl mb-4' }, 'ðŸ“°'),
            React.createElement('p', { className: 'text-2xl text-gray-600 mb-2' }, 'Brak aktualnoÅ›ci'),
            React.createElement('p', { className: 'text-lg text-gray-500' }, 'SprÃ³buj odÅ›wieÅ¼yÄ‡ za chwilÄ™')
          )
      );
    };

    const renderSettingsScreen = () => {
      return React.createElement('div', { className: 'space-y-6' },
        React.createElement('h2', { className: 'text-3xl md:text-4xl font-bold text-center mb-6 md:mb-8' }, 'Ustawienia'),
        
        React.createElement('div', { className: 'bg-white border-4 border-blue-500 p-6 md:p-8 rounded-3xl shadow-xl' },
          React.createElement('div', { className: 'flex items-center justify-between mb-6' },
            React.createElement('div', { className: 'flex-1 pr-4' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, 'Tryb Opieki Rodzinnej'),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 mt-2' }, 'Rodzina otrzymuje powiadomienia')
            ),
            React.createElement('button', {
              onClick: () => setCareMode(!careMode),
              className: `w-24 md:w-32 h-12 md:h-16 rounded-full transition-all ${careMode?'bg-green-500':'bg-gray-300'} relative flex-shrink-0`
            },
              React.createElement('div', {
                className: `w-8 md:w-12 h-8 md:h-12 bg-white rounded-full absolute top-2 transition-all ${careMode?'left-12 md:left-16':'left-2'}`
              })
            )
          ),
          React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 bg-blue-50 p-4 rounded-2xl' },
            careMode ? 'âœ“ Tryb aktywny - rodzina jest informowana' : 'âœ— Tryb wyÅ‚Ä…czony'
          )
        ),

        React.createElement('div', { className: 'bg-white border-4 border-red-500 p-6 md:p-8 rounded-3xl shadow-xl' },
          React.createElement('div', { className: 'flex items-center justify-between mb-6' },
            React.createElement('div', { className: 'flex-1 pr-4' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, 'Przycisk Awaryjny'),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 mt-2' }, 'Dostosuj wyglÄ…d, wiadomoÅ›ci i telefony alarmowe')
            ),
            React.createElement('button', {
              onClick: () => setShowEmergencySettings(true),
              className: 'bg-red-500 hover:bg-red-600 text-white p-4 rounded-2xl font-bold text-lg'
            }, 'Konfiguruj')
          ),
          React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 bg-red-50 p-4 rounded-2xl' },
            `${emergencySettings.enabled ? 'âœ“ Przycisk aktywny' : 'âœ— Przycisk wyÅ‚Ä…czony'} | Rozmiar: ${emergencySettings.size}px | Kolor: ${emergencySettings.color === 'red' ? 'Czerwony' : emergencySettings.color === 'blue' ? 'Niebieski' : 'PomaraÅ„czowy'}`
          )
        ),

        React.createElement('div', { className: 'bg-white border-4 border-green-500 p-6 md:p-8 rounded-3xl shadow-xl' },
          React.createElement('div', { className: 'flex items-center justify-between mb-6' },
            React.createElement('div', { className: 'flex-1 pr-4' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, 'Instalacja Aplikacji'),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 mt-2' }, 'Zainstaluj aplikacjÄ™ na swoim urzÄ…dzeniu')
            ),
            React.createElement('button', {
              onClick: handleInstallClick,
              className: 'bg-green-500 hover:bg-green-600 text-white p-4 rounded-2xl font-bold text-lg',
              disabled: !isInstallable
            }, isInstallable ? 'Zainstaluj' : 'NiedostÄ™pne')
          ),
          React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 bg-green-50 p-4 rounded-2xl' },
            isInstallable 
              ? 'Zainstaluj Senior-Easy na swoim urzÄ…dzeniu, aby korzystaÄ‡ z aplikacji jak z natywnej!'
              : 'Instalacja jest juÅ¼ dostÄ™pna lub aplikacja jest juÅ¼ zainstalowana. SprawdÅº menu przeglÄ…darki.'
          )
        ),

        React.createElement('div', { className: 'bg-white border-4 border-yellow-500 p-6 md:p-8 rounded-3xl shadow-xl' },
          React.createElement('div', { className: 'flex items-center justify-between mb-6' },
            React.createElement('div', { className: 'flex-1 pr-4' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, 'Powiadomienia'),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 mt-2' }, 'ZarzÄ…dzaj powiadomieniami')
            ),
            React.createElement('button', {
              onClick: () => setCurrentScreen('notifications'),
              className: 'bg-yellow-500 hover:bg-yellow-600 text-white p-4 rounded-2xl font-bold text-lg relative'
            },
              'ðŸ“¢',
              unreadNotificationsCount > 0 && React.createElement('span', { className: 'notification-badge' }, unreadNotificationsCount)
            )
          ),
          React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 bg-yellow-50 p-4 rounded-2xl' },
            `Masz ${unreadNotificationsCount} nieprzeczytanych powiadomieÅ„`
          )
        ),

        React.createElement('div', { className: 'bg-white border-4 border-red-500 p-6 md:p-8 rounded-3xl shadow-xl' },
          React.createElement('div', { className: 'flex items-center justify-between mb-6' },
            React.createElement('div', { className: 'flex-1 pr-4' },
              React.createElement('div', { className: 'text-2xl md:text-3xl font-bold text-gray-800' }, 'WyczyÅ›Ä‡ wszystkie dane'),
              React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 mt-2' }, 'UsuÅ„ wszystkie zapisane leki, kontakty i ustawienia')
            ),
            React.createElement('button', {
              onClick: clearData,
              className: 'bg-red-500 hover:bg-red-600 text-white p-4 rounded-2xl font-bold text-lg'
            }, 'WyczyÅ›Ä‡')
          ),
          React.createElement('div', { className: 'text-lg md:text-xl text-gray-600 bg-red-50 p-4 rounded-2xl' },
            'Uwaga: Ta operacja jest nieodwracalna! Wszystkie dane zostanÄ… trwale usuniÄ™te.'
          )
        ),

        React.createElement('div', { className: 'bg-purple-50 border-4 border-purple-300 p-6 md:p-8 rounded-3xl' },
          React.createElement('h3', { className: 'text-2xl md:text-3xl font-bold text-center mb-4' }, 'Informacje o Aplikacji'),
          React.createElement('div', { className: 'space-y-3 text-lg md:text-xl text-gray-700' },
            React.createElement('p', null, React.createElement('strong', null, 'Wersja:'), ' 3.2 PWA'),
            React.createElement('p', null, React.createElement('strong', null, 'Typ:'), ' Progressive Web App'),
            React.createElement('p', null, React.createElement('strong', null, 'Wsparcie:'), ' +480 800 800'),
            React.createElement('p', null, React.createElement('strong', null, 'Dane:'), ' Wszystkie dane sÄ… zapisywane lokalnie w przeglÄ…darce'),
            React.createElement('p', null, React.createElement('strong', null, 'Lokalizacja:'), ' ' + 
              (hasAskedForLocation ? 
                (locationPermission === 'granted' ? 'âœ“ Pozwolenie udzielone' : 
                 locationPermission === 'denied' ? 'âœ— Pozwolenie odrzucone' : 'â³ Oczekiwanie') 
                : 'â“ Jeszcze nie pytano'
              )
            ),
            React.createElement('p', null, React.createElement('strong', null, 'Å¹rÃ³dÅ‚a wiadomoÅ›ci:'), ' Onet.pl'),
            React.createElement('p', { className: 'text-base md:text-lg text-gray-600 mt-4' },
              'Aplikacja dziaÅ‚a offline i moÅ¼e byÄ‡ zainstalowana na urzÄ…dzeniu mobilnym lub komputerze.'
            )
          )
        )
      );
    };

    // ========== KOMUNIKATY I DIALOGI ==========
    const renderEmergencySettings = () => {
      if (!showEmergencySettings) return null;

      return React.createElement('div', {
        className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4',
        onClick: () => setShowEmergencySettings(false)
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-2xl max-w-2xl w-full p-6 md:p-8 max-h-[90vh] overflow-y-auto',
          onClick: e => e.stopPropagation()
        },
          React.createElement('h3', { className: 'text-2xl md:text-3xl font-bold text-center mb-6 text-red-600' }, 'Ustawienia Przycisku Awaryjnego'),
          
          React.createElement('div', { className: 'flex mb-6 border-b space-x-2' },
            React.createElement('button', {
              className: `px-4 py-2 rounded-t ${emergencySettingsTab === 'appearance' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`,
              onClick: () => setEmergencySettingsTab('appearance')
            }, 'WyglÄ…d'),
            React.createElement('button', {
              className: `px-4 py-2 rounded-t ${emergencySettingsTab === 'messages' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`,
              onClick: () => setEmergencySettingsTab('messages')
            }, 'WiadomoÅ›ci'),
            React.createElement('button', {
              className: `px-4 py-2 rounded-t ${emergencySettingsTab === 'phones' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`,
              onClick: () => setEmergencySettingsTab('phones')
            }, 'Telefony')
          ),
          
          emergencySettingsTab === 'appearance' && React.createElement('div', { className: 'space-y-6' },
            React.createElement('div', { className: 'flex items-center justify-between' },
              React.createElement('span', { className: 'text-xl font-bold' }, 'WÅ‚Ä…czony'),
              React.createElement('button', {
                onClick: () => updateEmergencySettings('enabled', !emergencySettings.enabled),
                className: `w-16 h-8 rounded-full transition-all ${emergencySettings.enabled ? 'bg-green-500' : 'bg-gray-300'} relative`
              },
                React.createElement('div', {
                  className: `w-6 h-6 bg-white rounded-full absolute top-1 transition-all ${emergencySettings.enabled ? 'left-9' : 'left-1'}`
                })
              )
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-xl font-bold mb-2 block' }, 'Pozycja przycisku'),
              React.createElement('select', {
                value: emergencySettings.position,
                onChange: e => updateEmergencySettings('position', e.target.value),
                className: 'w-full text-xl p-3 border-2 border-gray-300 rounded-2xl'
              },
                React.createElement('option', { value: 'bottom-right' }, 'Prawy dolny rÃ³g'),
                React.createElement('option', { value: 'bottom-left' }, 'Lewy dolny rÃ³g'),
                React.createElement('option', { value: 'top-right' }, 'Prawy gÃ³rny rÃ³g'),
                React.createElement('option', { value: 'top-left' }, 'Lewy gÃ³rny rÃ³g')
              )
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-xl font-bold mb-2 block' }, `Rozmiar przycisku: ${emergencySettings.size}px`),
              React.createElement('input', {
                type: 'range',
                min: '50',
                max: '100',
                value: emergencySettings.size,
                onChange: e => updateEmergencySettings('size', parseInt(e.target.value)),
                className: 'w-full'
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-xl font-bold mb-2 block' }, 'Kolor przycisku'),
              React.createElement('div', { className: 'flex space-x-4' },
                ['red', 'blue', 'orange'].map(color =>
                  React.createElement('button', {
                    key: color,
                    onClick: () => updateEmergencySettings('color', color),
                    className: `w-12 h-12 rounded-full ${emergencySettings.color === color ? 'ring-4 ring-blue-500' : ''} ${
                      color === 'red' ? 'bg-red-500' : 
                      color === 'blue' ? 'bg-blue-500' : 
                      'bg-orange-500'
                    }`
                  })
                )
              )
            ),
            React.createElement('div', { className: 'flex items-center justify-between' },
              React.createElement('span', { className: 'text-xl font-bold' }, 'Efekt pulsowania'),
              React.createElement('button', {
                onClick: () => updateEmergencySettings('pulse', !emergencySettings.pulse),
                className: `w-16 h-8 rounded-full transition-all ${emergencySettings.pulse ? 'bg-green-500' : 'bg-gray-300'} relative`
              },
                React.createElement('div', {
                  className: `w-6 h-6 bg-white rounded-full absolute top-1 transition-all ${emergencySettings.pulse ? 'left-9' : 'left-1'}`
                })
              )
            )
          ),

          emergencySettingsTab === 'messages' && React.createElement('div', { className: 'space-y-4' },
            React.createElement('h4', { className: 'text-lg font-bold' }, 'WiadomoÅ›ci awaryjne'),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-lg font-bold mb-1 block' }, 'WiadomoÅ›Ä‡ dla rodziny'),
              React.createElement('textarea', {
                value: emergencySettings.familyMessage,
                onChange: e => updateEmergencySettings('familyMessage', e.target.value),
                className: 'w-full p-3 border-2 border-gray-300 rounded-2xl',
                rows: 2
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-lg font-bold mb-1 block' }, 'WiadomoÅ›Ä‡ medyczna'),
              React.createElement('textarea', {
                value: emergencySettings.medicalMessage,
                onChange: e => updateEmergencySettings('medicalMessage', e.target.value),
                className: 'w-full p-3 border-2 border-gray-300 rounded-2xl',
                rows: 2
              })
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-lg font-bold mb-1 block' }, 'WiadomoÅ›Ä‡ dla sÅ‚uÅ¼b'),
              React.createElement('textarea', {
                value: emergencySettings.servicesMessage,
                onChange: e => updateEmergencySettings('servicesMessage', e.target.value),
                className: 'w-full p-3 border-2 border-gray-300 rounded-2xl',
                rows: 2
              })
            )
          ),

          emergencySettingsTab === 'phones' && React.createElement('div', { className: 'space-y-6' },
            React.createElement('h4', { className: 'text-lg font-bold' }, 'Numery telefonÃ³w alarmowych'),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-lg font-bold mb-2 block' }, 'Wybierz typ telefonÃ³w:'),
              React.createElement('select', {
                value: editingPhoneType,
                onChange: e => setEditingPhoneType(e.target.value),
                className: 'w-full text-xl p-3 border-2 border-gray-300 rounded-2xl'
              },
                React.createElement('option', { value: 'family' }, 'Rodzina'),
                React.createElement('option', { value: 'medical' }, 'Medyczne'),
                React.createElement('option', { value: 'services' }, 'SÅ‚uÅ¼by')
              )
            ),
            React.createElement('div', { className: 'flex space-x-2' },
              React.createElement('input', {
                type: 'text',
                placeholder: 'WprowadÅº numer telefonu',
                value: newPhoneNumber,
                onChange: e => setNewPhoneNumber(e.target.value),
                className: 'flex-1 p-3 border-2 border-gray-300 rounded-2xl'
              }),
              React.createElement('button', {
                onClick: addPhoneNumber,
                className: 'bg-green-500 hover:bg-green-600 text-white p-3 rounded-2xl font-bold'
              }, '+')
            ),
            React.createElement('div', null,
              React.createElement('label', { className: 'text-lg font-bold mb-2 block' },
                editingPhoneType === 'family' && 'Numery rodziny',
                editingPhoneType === 'medical' && 'Numery medyczne',
                editingPhoneType === 'services' && 'Numery sÅ‚uÅ¼b'
              ),
              React.createElement('div', { className: 'border rounded-2xl p-3 max-h-48 overflow-y-auto' },
                emergencySettings[`${editingPhoneType}Phones`]?.length > 0 ?
                  emergencySettings[`${editingPhoneType}Phones`].map((phone, index) =>
                    React.createElement('div', { key: index, className: 'flex justify-between items-center p-2 border-b last:border-0' },
                      React.createElement('span', { className: 'font-mono' }, phone),
                      React.createElement('button', {
                        onClick: () => removePhoneNumber(index, editingPhoneType),
                        className: 'bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm'
                      }, 'UsuÅ„')
                    )
                  )
                :
                  React.createElement('p', { className: 'text-gray-500 text-center py-4' }, 'Brak zapisanych numerÃ³w')
              )
            ),
            React.createElement('div', { className: 'bg-blue-50 p-4 rounded-2xl' },
              React.createElement('p', { className: 'text-sm text-blue-800' },
                React.createElement('strong', null, 'Uwaga:'), ' W przypadku aktywacji pomocy, aplikacja zadzwoni pod pierwszy numer z listy.'
              )
            )
          ),

          React.createElement('button', {
            onClick: () => setShowEmergencySettings(false),
            className: 'w-full bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-2xl font-bold text-xl mt-6'
          }, 'Zapisz i zamknij')
        )
      );
    };

    const renderNotifyDialog = () => {
      if (!showNotifyDialog || !selectedMedication) return null;

      const familyWithApps = familyContacts.filter(c => c.app === 'whatsapp' || c.app === 'viber');

      return React.createElement('div', {
        className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4',
        onClick: () => { setShowNotifyDialog(false); setSelectedMedication(null); }
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl shadow-2xl max-w-2xl w-full p-6 md:p-8 max-h-[90vh] overflow-y-auto',
          onClick: e => e.stopPropagation()
        },
          React.createElement('h3', { className: 'text-2xl md:text-3xl font-bold text-center mb-4 text-green-600' }, 'âœ… Lek przyjÄ™ty!'),
          React.createElement('p', { className: 'text-xl md:text-2xl text-center mb-6 text-gray-700' },
            `Kogo chcesz powiadomiÄ‡ o przyjÄ™ciu leku "${selectedMedication.name}"?`
          ),
          
          familyWithApps.length > 0 ?
            React.createElement(React.Fragment, null,
              React.createElement('div', { className: 'space-y-3 mb-6' },
                familyWithApps.map(contact =>
                  React.createElement('button', {
                    key: contact.id,
                    onClick: () => sendNotification(contact.id),
                    className: 'w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white p-4 md:p-6 rounded-2xl shadow-lg flex items-center space-x-4 transition-all'
                  },
                    React.createElement('span', { className: 'text-4xl md:text-5xl' }, contact.avatar),
                    React.createElement('div', { className: 'flex-1 text-left' },
                      React.createElement('div', { className: 'text-xl md:text-2xl font-bold' }, contact.name),
                      React.createElement('div', { className: 'text-base md:text-lg opacity-90' },
                        contact.app === 'whatsapp' ? 'ðŸ“± WhatsApp' : 'ðŸ’¬ Viber'
                      )
                    ),
                    React.createElement('span', { className: 'text-3xl md:text-4xl' }, 'âœ‰ï¸')
                  )
                )
              ),
              familyWithApps.length > 1 && React.createElement('button', {
                onClick: sendToAll,
                className: 'w-full bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white p-4 md:p-6 rounded-2xl shadow-lg font-bold text-xl md:text-2xl mb-4 transition-all'
              }, 'ðŸ“¢ WyÅ›lij do wszystkich')
            )
          :
            React.createElement('div', { className: 'bg-yellow-50 border-4 border-yellow-400 p-6 rounded-2xl text-center' },
              React.createElement('p', { className: 'text-xl md:text-2xl font-bold text-yellow-800 mb-2' }, 'âš ï¸ Brak kontaktÃ³w'),
              React.createElement('p', { className: 'text-lg md:text-xl text-yellow-700' },
                'Dodaj czÅ‚onkÃ³w rodziny z WhatsApp lub Viber w zakÅ‚adce "Rodzina"'
              )
            ),

          React.createElement('button', {
            onClick: () => { setShowNotifyDialog(false); setSelectedMedication(null); },
            className: 'w-full bg-gray-400 hover:bg-gray-500 text-white p-4 md:p-5 rounded-2xl font-bold text-xl md:text-2xl transition-colors'
          }, 'âŒ Nie wysyÅ‚aj')
        )
      );
    };

    // ========== GÅÃ“WNY RENDER ==========
    if (isLoading) {
      return React.createElement('div', { className: 'loading-screen' },
        React.createElement('div', { className: 'loading-spinner' }),
        React.createElement('h1', { className: 'text-4xl font-bold text-white mb-4' }, 'Senior-Easy'),
        React.createElement('p', { className: 'text-white text-xl' }, 'Åadowanie aplikacji...')
      );
    }

    return React.createElement('div', null,
      emergencySettings.enabled && React.createElement('button', {
        className: 'emergency-button',
        onClick: () => setShowEmergencyDialog(true),
        style: getEmergencyButtonStyle()
      }, 'SOS'),

      showEmergencyDialog && React.createElement('div', { 
        className: 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50',
        onClick: () => setShowEmergencyDialog(false)
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl p-6 w-11/12 max-w-md shadow-2xl',
          onClick: e => e.stopPropagation()
        },
          React.createElement('h2', { className: 'text-2xl font-bold text-center mb-4 text-red-600' }, 'PILNA POMOC'),
          React.createElement('p', { className: 'text-center mb-6' }, 'Wybierz rodzaj pomocy:'),
          
          React.createElement('div', {
            className: 'flex items-center p-4 mb-3 bg-gray-100 rounded-xl cursor-pointer hover:bg-gray-200',
            onClick: () => sendEmergencyMessage('family')
          },
            React.createElement('div', { className: 'text-3xl mr-4' }, 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦'),
            React.createElement('div', { className: 'flex-1' },
              React.createElement('div', { className: 'font-bold text-lg' }, 'Powiadom rodzinÄ™'),
              React.createElement('div', { className: 'text-sm text-gray-600' }, 'WyÅ›lij wiadomoÅ›Ä‡ przez WhatsApp/Viber')
            )
          ),
          
          React.createElement('div', {
            className: 'flex items-center p-4 mb-3 bg-gray-100 rounded-xl cursor-pointer hover:bg-gray-200',
            onClick: () => sendEmergencyMessage('medical')
          },
            React.createElement('div', { className: 'text-3xl mr-4' }, 'ðŸš‘'),
            React.createElement('div', { className: 'flex-1' },
              React.createElement('div', { className: 'font-bold text-lg' }, 'Pomoc medyczna'),
              React.createElement('div', { className: 'text-sm text-gray-600' }, 'Powiadom rodzinÄ™ i zadzwoÅ„ po pomoc')
            )
          ),
          
          React.createElement('div', {
            className: 'flex items-center p-4 mb-3 bg-gray-100 rounded-xl cursor-pointer hover:bg-gray-200',
            onClick: () => sendEmergencyMessage('services')
          },
            React.createElement('div', { className: 'text-3xl mr-4' }, 'ðŸ“ž'),
            React.createElement('div', { className: 'flex-1' },
              React.createElement('div', { className: 'font-bold text-lg' }, 'ZadzwoÅ„ po pomoc'),
              React.createElement('div', { className: 'text-sm text-gray-600' }, 'ZadzwoÅ„ do sÅ‚uÅ¼b lub numeru alarmowego')
            )
          ),
          
          React.createElement('button', {
            className: 'w-full bg-gray-400 hover:bg-gray-500 text-white p-4 rounded-xl font-bold text-lg mt-4',
            onClick: () => setShowEmergencyDialog(false)
          }, 'Anuluj')
        )
      ),

      showInstallPrompt && isInstallable && React.createElement('div', { className: 'fixed bottom-5 left-1/2 -translate-x-1/2 z-50 bg-blue-600 text-white p-4 rounded-2xl shadow-2xl max-w-md w-11/12' },
        React.createElement('div', { className: 'flex items-center justify-between' },
          React.createElement('div', { className: 'flex-1' },
            React.createElement('p', { className: 'text-lg font-bold' }, 'Zainstaluj Senior-Easy'),
            React.createElement('p', { className: 'text-sm' }, 'UÅ¼ywaj aplikacji jak natywnej!')
          ),
          React.createElement('div', { className: 'flex space-x-2' },
            React.createElement('button', {
              onClick: handleInstallClick,
              className: 'bg-white text-blue-600 px-4 py-2 rounded-xl font-bold'
            }, 'Instaluj'),
            React.createElement('button', {
              onClick: () => setShowInstallPrompt(false),
              className: 'bg-blue-700 px-4 py-2 rounded-xl'
            }, 'PÃ³Åºniej')
          )
        )
      ),

      React.createElement('div', { className: 'bg-white rounded-2xl sm:rounded-3xl shadow-2xl p-3 sm:p-4 mb-4 sm:mb-6 flex justify-between items-center' },
        React.createElement('button', {
          onClick: () => setCurrentScreen('home'),
          className: 'bg-blue-500 hover:bg-blue-600 active:bg-blue-700 text-white p-2 sm:p-4 rounded-xl sm:rounded-2xl transition-colors'
        }, React.createElement('span', { className: 'text-3xl sm:text-5xl' }, 'ðŸ ')),
        
        React.createElement('div', { className: 'text-lg sm:text-2xl md:text-3xl font-bold text-gray-800 px-2 text-center' },
          currentScreen === 'home' ? 'Strona GÅ‚Ã³wna' :
          currentScreen === 'video' ? 'Rozmowa Wideo' :
          currentScreen === 'medications' ? 'Leki' :
          currentScreen === 'contacts' ? 'Rodzina' :
          currentScreen === 'services' ? 'UsÅ‚ugi' :
          currentScreen === 'news' ? 'AktualnoÅ›ci' :
          currentScreen === 'notifications' ? `Powiadomienia (${unreadNotificationsCount})` :
          'Ustawienia'
        ),
        
        React.createElement('button', {
          onClick: () => setCurrentScreen('settings'),
          className: 'bg-gray-500 hover:bg-gray-600 active:bg-gray-700 text-white p-2 sm:p-4 rounded-xl sm:rounded-2xl transition-colors relative'
        },
          React.createElement('span', { className: 'text-3xl sm:text-5xl' }, 'âš™ï¸'),
          unreadNotificationsCount > 0 && React.createElement('span', { className: 'notification-badge' }, unreadNotificationsCount)
        )
      ),

      React.createElement('div', { className: 'bg-white rounded-2xl sm:rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8' },
        currentScreen === 'home' && renderHomeScreen(),
        currentScreen === 'video' && renderVideoScreen(),
        currentScreen === 'medications' && renderMedicationsScreen(),
        currentScreen === 'contacts' && renderContactsScreen(),
        currentScreen === 'services' && renderServicesScreen(),
        currentScreen === 'news' && renderNewsScreen(),
        currentScreen === 'notifications' && renderNotificationsScreen(),
        currentScreen === 'settings' && renderSettingsScreen()
      ),

      renderEmergencySettings(),
      renderNotifyDialog(),

      showLocationPrompt && !hasAskedForLocation && React.createElement('div', { 
        className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'
      },
        React.createElement('div', {
          className: 'bg-white rounded-3xl p-6 max-w-md w-full shadow-2xl'
        },
          React.createElement('h3', { className: 'text-2xl font-bold text-center mb-4' }, 'ðŸŒ Lokalizacja'),
          React.createElement('p', { className: 'text-center mb-6' }, 
            'Czy chcesz pozwoliÄ‡ aplikacji na dostÄ™p do Twojej lokalizacji, aby wyÅ›wietlaÄ‡ aktualnÄ… pogodÄ™ dla Twojej okolicy?'
          ),
          React.createElement('p', { className: 'text-center text-sm text-gray-600 mb-6' }, 
            'Zapytamy tylko raz. MoÅ¼esz zawsze zmieniÄ‡ tÄ™ decyzjÄ™ w ustawieniach przeglÄ…darki.'
          ),
          React.createElement('div', { className: 'grid grid-cols-2 gap-3 mt-4' },
            React.createElement('button', {
              onClick: () => {
                setShowLocationPrompt(false);
                setHasAskedForLocation(true);
                localStorage.setItem('seniorEasy_locationAsked', 'true');
                fetchWeather(52.2297, 21.0122);
              },
              className: 'w-full bg-gray-400 hover:bg-gray-500 text-white p-4 rounded-2xl font-bold'
            }, 'ðŸš« Nie, dziÄ™ki'),
            React.createElement('button', {
              onClick: async () => {
                try {
                  await getUserLocation();
                } catch (error) {
                  setShowLocationPrompt(false);
                  fetchWeather(52.2297, 21.0122);
                }
              },
              className: 'w-full bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-2xl font-bold'
            }, 'ðŸ“ Tak, pozwÃ³l')
          )
        )
      ),

      React.createElement('div', { className: 'text-center mt-6 text-gray-600 text-lg md:text-xl' },
        React.createElement('p', null, 'Senior-Easy Â© 2025 | WiadomoÅ›ci: Onet.pl | Pomoc: +480 800 800')
      )
    );
  }

  ReactDOM.render(React.createElement(SeniorEasyApp), document.getElementById('root'));
  </script>
</body>
</html>
